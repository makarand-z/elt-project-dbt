[0m20:43:26.346272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44c06c2d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44c1677980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44c06c17c0>]}


============================== 20:43:26.361844 | ed565bac-b393-410b-91c4-154ad2550f58 ==============================
[0m20:43:26.361844 [info ] [MainThread]: Running with dbt=1.9.0
[0m20:43:26.364928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m20:43:26.382245 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m20:43:26.387526 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.19325364, "process_in_blocks": "0", "process_kernel_time": 0.506226, "process_mem_max_rss": "87528", "process_out_blocks": "1464", "process_user_time": 3.963845}
[0m20:43:26.389481 [debug] [MainThread]: Command `dbt run` failed at 20:43:26.389259 after 0.20 seconds
[0m20:43:26.390854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44c0721760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44c06c2d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44c0194080>]}
[0m20:43:26.392130 [debug] [MainThread]: Flushing usage events
[0m20:43:26.871786 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:52:25.356112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1244c0bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f124609c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1244630710>]}


============================== 20:52:25.366299 | ada1fa34-c36e-4759-9c22-d6ec4af1ef89 ==============================
[0m20:52:25.366299 [info ] [MainThread]: Running with dbt=1.9.0
[0m20:52:25.368853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:52:25.378316 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m20:52:25.381447 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.111868426, "process_in_blocks": "0", "process_kernel_time": 0.23925, "process_mem_max_rss": "87332", "process_out_blocks": "1464", "process_user_time": 2.114976}
[0m20:52:25.382884 [debug] [MainThread]: Command `dbt run` failed at 20:52:25.382720 after 0.11 seconds
[0m20:52:25.383967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1245af19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12443763c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f124485e480>]}
[0m20:52:25.385056 [debug] [MainThread]: Flushing usage events
[0m20:52:25.763234 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:02:05.153479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee86a17860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee86b23380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee885ee0c0>]}


============================== 21:02:05.163111 | a99d660c-524a-4bfd-8a16-313934b172aa ==============================
[0m21:02:05.163111 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:02:05.165485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m21:02:05.176339 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m21:02:05.178527 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.109386384, "process_in_blocks": "0", "process_kernel_time": 0.237995, "process_mem_max_rss": "87396", "process_out_blocks": "1464", "process_user_time": 1.884926}
[0m21:02:05.180049 [debug] [MainThread]: Command `dbt run` failed at 21:02:05.179899 after 0.11 seconds
[0m21:02:05.181187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee89efea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee87101b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee86777e30>]}
[0m21:02:05.182268 [debug] [MainThread]: Flushing usage events
[0m21:02:05.494340 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:08:39.595605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc3b2dbe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc3aa42690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc3a815220>]}


============================== 21:08:39.604585 | 52b18888-96f5-4086-9ed2-883f51b09bed ==============================
[0m21:08:39.604585 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:08:39.606733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:08:39.908113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52b18888-96f5-4086-9ed2-883f51b09bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc3af1bb00>]}
[0m21:08:40.022245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52b18888-96f5-4086-9ed2-883f51b09bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc3a533140>]}
[0m21:08:40.025344 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:08:40.146977 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m21:08:40.152685 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:08:40.154355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '52b18888-96f5-4086-9ed2-883f51b09bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc3bf76330>]}
[0m21:08:41.966328 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/example/schema.yml @ models: {'name': 'actors', 'description': 'This table contains details about actors.', 'columns': [{'name': 'actor_id', 'description': 'Unique identifier of the actor.', 'tests': ['unique', 'not_null']}, {'name': 'name', 'description': 'First name of the actor.', 'tests': None}], 'original_file_path': 'models/example/schema.yml', 'yaml_key': 'models', 'package_name': 'custom_postgres'} - at path ['columns'][1]['tests']: None is not of type 'array'
[0m21:08:41.970293 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4700313, "process_in_blocks": "0", "process_kernel_time": 0.233314, "process_mem_max_rss": "101944", "process_out_blocks": "1488", "process_user_time": 3.994336}
[0m21:08:41.973068 [debug] [MainThread]: Command `dbt run` failed at 21:08:41.972737 after 2.47 seconds
[0m21:08:41.974941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc3dd7ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc38a797f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc38b4a360>]}
[0m21:08:41.976517 [debug] [MainThread]: Flushing usage events
[0m21:08:42.291688 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:07:39.791306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8345c50a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff835c27650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff833c18cb0>]}


============================== 23:07:39.853981 | cf6180e8-675c-4223-8565-96797fd7a164 ==============================
[0m23:07:39.853981 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:07:39.856058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:07:40.344369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf6180e8-675c-4223-8565-96797fd7a164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff833c7b560>]}
[0m23:07:40.487966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf6180e8-675c-4223-8565-96797fd7a164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8339c3bc0>]}
[0m23:07:40.489946 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:07:40.654615 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m23:07:40.661196 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:07:40.662919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cf6180e8-675c-4223-8565-96797fd7a164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff832111040>]}
[0m23:07:44.038059 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.custom_postgres.films' (models/example/films.sql) depends on a source named 'destination_db.films' which was not found
[0m23:07:44.041540 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.564001, "process_in_blocks": "0", "process_kernel_time": 0.538833, "process_mem_max_rss": "102488", "process_out_blocks": "1488", "process_user_time": 8.182284}
[0m23:07:44.044743 [debug] [MainThread]: Command `dbt run` failed at 23:07:44.044393 after 4.57 seconds
[0m23:07:44.047252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff833a54170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff831f3cc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff831f89370>]}
[0m23:07:44.050658 [debug] [MainThread]: Flushing usage events
[0m23:07:44.347655 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:10:26.959516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f121714d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f121714d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f121714c2c0>]}


============================== 23:10:26.967806 | cf077a87-1a99-49b8-b4e6-78e006b9df38 ==============================
[0m23:10:26.967806 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:10:26.970028 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root', 'log_path': '/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m23:10:26.983473 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m23:10:26.985920 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.11858111, "process_in_blocks": "0", "process_kernel_time": 0.16972, "process_mem_max_rss": "87356", "process_out_blocks": "1464", "process_user_time": 2.066592}
[0m23:10:26.987859 [debug] [MainThread]: Command `dbt run` failed at 23:10:26.987611 after 0.12 seconds
[0m23:10:26.989062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f121710be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f121714c530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12178027b0>]}
[0m23:10:26.990222 [debug] [MainThread]: Flushing usage events
[0m23:10:27.461560 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:12:20.723086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20a7fd1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20a7cc0620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20a7fd3a70>]}


============================== 23:12:20.730805 | fc5a641a-8397-442f-bff5-540086f1ad72 ==============================
[0m23:12:20.730805 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:12:20.733105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:12:20.745174 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m23:12:20.747322 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.12905988, "process_in_blocks": "0", "process_kernel_time": 0.271367, "process_mem_max_rss": "87424", "process_out_blocks": "1464", "process_user_time": 1.799064}
[0m23:12:20.748939 [debug] [MainThread]: Command `dbt run` failed at 23:12:20.748718 after 0.13 seconds
[0m23:12:20.750203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20a86c8e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20a81dcfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20a7cc4770>]}
[0m23:12:20.751337 [debug] [MainThread]: Flushing usage events
[0m23:12:21.069133 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:14:04.702737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6abbb7ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6abe189e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ac2fe7e0>]}


============================== 23:14:04.711165 | 79365ecc-932f-4678-8a4d-d872df9256d6 ==============================
[0m23:14:04.711165 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:14:04.713274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:14:04.991358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79365ecc-932f-4678-8a4d-d872df9256d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6abbb9220>]}
[0m23:14:05.073677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79365ecc-932f-4678-8a4d-d872df9256d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6aba6e810>]}
[0m23:14:05.076000 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:14:05.187794 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m23:14:05.194008 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:14:05.195852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '79365ecc-932f-4678-8a4d-d872df9256d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6aa1653a0>]}
[0m23:14:07.078518 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.custom_postgres.films' (models/example/films.sql) depends on a source named 'destination_db.films' which was not found
[0m23:14:07.082254 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4665256, "process_in_blocks": "48", "process_kernel_time": 0.346857, "process_mem_max_rss": "102744", "process_out_blocks": "1488", "process_user_time": 4.122651}
[0m23:14:07.084758 [debug] [MainThread]: Command `dbt run` failed at 23:14:07.084453 after 2.47 seconds
[0m23:14:07.086334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6abd003e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ab91b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6a9cfe270>]}
[0m23:14:07.087809 [debug] [MainThread]: Flushing usage events
[0m23:14:07.326857 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:19.047708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6894ca6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68930c0680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6894c142c0>]}


============================== 23:26:19.056785 | 464b6cba-8a2f-49a2-a4d5-ddd5bfab1986 ==============================
[0m23:26:19.056785 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:26:19.058535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:26:19.070301 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m23:26:19.072636 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.11421077, "process_in_blocks": "82080", "process_kernel_time": 0.348654, "process_mem_max_rss": "86816", "process_out_blocks": "1464", "process_user_time": 1.966024}
[0m23:26:19.073842 [debug] [MainThread]: Command `dbt run` failed at 23:26:19.073691 after 0.12 seconds
[0m23:26:19.074862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f689373cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6892f33770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6893820fb0>]}
[0m23:26:19.075894 [debug] [MainThread]: Flushing usage events
[0m23:26:19.478803 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:27:11.075291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516a984620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516a986030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516aac0980>]}


============================== 23:27:11.083251 | 631a6b29-30e2-4b02-bbb6-659ad6debd1b ==============================
[0m23:27:11.083251 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:27:11.085247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:27:11.440847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '631a6b29-30e2-4b02-bbb6-659ad6debd1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5169326240>]}
[0m23:27:11.527250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '631a6b29-30e2-4b02-bbb6-659ad6debd1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51672044d0>]}
[0m23:27:11.532799 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:27:11.665814 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m23:27:11.671180 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:27:11.673066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '631a6b29-30e2-4b02-bbb6-659ad6debd1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51672b0800>]}
[0m23:27:13.869005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '631a6b29-30e2-4b02-bbb6-659ad6debd1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5166e35b20>]}
[0m23:27:14.181367 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:27:14.190004 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:27:14.241860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '631a6b29-30e2-4b02-bbb6-659ad6debd1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5165dbd5e0>]}
[0m23:27:14.243482 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m23:27:14.245366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '631a6b29-30e2-4b02-bbb6-659ad6debd1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5165d73cb0>]}
[0m23:27:14.250231 [info ] [MainThread]: 
[0m23:27:14.251977 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:27:14.253609 [info ] [MainThread]: 
[0m23:27:14.255745 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:27:14.264095 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m23:27:14.328383 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m23:27:14.330184 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m23:27:14.331537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:14.413915 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.082 seconds
[0m23:27:14.416555 [debug] [ThreadPool]: On list_destination_db: Close
[0m23:27:14.419408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m23:27:14.437705 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:27:14.439424 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m23:27:14.441145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:14.473016 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m23:27:14.474660 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:27:14.476420 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:27:14.487043 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m23:27:14.490575 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m23:27:14.493577 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m23:27:14.503911 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:14.505135 [debug] [MainThread]: On master: BEGIN
[0m23:27:14.506149 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:27:14.529351 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m23:27:14.531267 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:14.533074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:27:14.540524 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m23:27:14.543457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '631a6b29-30e2-4b02-bbb6-659ad6debd1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51650dd010>]}
[0m23:27:14.545018 [debug] [MainThread]: On master: ROLLBACK
[0m23:27:14.548146 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:14.549768 [debug] [MainThread]: On master: BEGIN
[0m23:27:14.554942 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:27:14.556560 [debug] [MainThread]: On master: COMMIT
[0m23:27:14.558257 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:14.559900 [debug] [MainThread]: On master: COMMIT
[0m23:27:14.563435 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:27:14.565098 [debug] [MainThread]: On master: Close
[0m23:27:14.569604 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m23:27:14.571883 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m23:27:14.573759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m23:27:14.575677 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m23:27:14.597203 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m23:27:14.619427 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m23:27:14.702894 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m23:27:14.720376 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:27:14.721731 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m23:27:14.722976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:14.743099 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m23:27:14.744577 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:27:14.745666 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m23:27:14.749340 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.003 seconds
[0m23:27:14.759517 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:27:14.760636 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m23:27:14.763405 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:27:14.768302 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:27:14.769651 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m23:27:14.772331 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:27:14.803054 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m23:27:14.804269 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:27:14.805304 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m23:27:14.812002 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:27:14.821796 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m23:27:14.830810 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:27:14.832330 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m23:27:14.838813 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m23:27:14.843423 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m23:27:14.846862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '631a6b29-30e2-4b02-bbb6-659ad6debd1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516aa42900>]}
[0m23:27:14.848645 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.27s]
[0m23:27:14.850928 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m23:27:14.852620 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m23:27:14.854498 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m23:27:14.856465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m23:27:14.858248 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m23:27:14.863393 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m23:27:14.871852 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m23:27:14.879829 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m23:27:14.887660 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:27:14.888779 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m23:27:14.889758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:14.911983 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m23:27:14.913544 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:27:14.914889 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m23:27:14.919211 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.003 seconds
[0m23:27:14.925510 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:27:14.926701 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m23:27:14.929322 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:27:14.933930 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:27:14.935097 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m23:27:14.938126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:27:14.941692 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m23:27:14.942932 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:27:14.943988 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m23:27:14.948181 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:27:14.953440 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m23:27:14.955745 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:27:14.957128 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m23:27:14.962161 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m23:27:14.964844 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m23:27:14.966321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '631a6b29-30e2-4b02-bbb6-659ad6debd1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5164f80500>]}
[0m23:27:14.968189 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.11s]
[0m23:27:14.970334 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m23:27:14.972152 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m23:27:14.973943 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m23:27:14.975635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m23:27:14.976982 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m23:27:14.982191 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m23:27:14.990220 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m23:27:14.996106 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m23:27:15.004989 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:27:15.006131 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m23:27:15.007217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:15.030615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m23:27:15.031886 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:27:15.032993 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m23:27:15.036874 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.003 seconds
[0m23:27:15.042543 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:27:15.043665 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m23:27:15.046262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:27:15.051616 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:27:15.052742 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m23:27:15.055445 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:27:15.058312 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m23:27:15.059389 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:27:15.060363 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m23:27:15.064349 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:27:15.068665 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m23:27:15.070469 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:27:15.071744 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m23:27:15.077695 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m23:27:15.080142 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m23:27:15.081588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '631a6b29-30e2-4b02-bbb6-659ad6debd1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5164f7a2a0>]}
[0m23:27:15.083316 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.11s]
[0m23:27:15.085581 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m23:27:15.087791 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m23:27:15.088966 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m23:27:15.090289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m23:27:15.091304 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m23:27:15.098543 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m23:27:15.106408 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m23:27:15.112831 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m23:27:15.120530 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:27:15.121646 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m23:27:15.122695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:15.145658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m23:27:15.146787 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:27:15.147916 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m23:27:15.153740 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.004 seconds
[0m23:27:15.158754 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:27:15.159980 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m23:27:15.162597 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:27:15.165909 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m23:27:15.167254 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:27:15.168332 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m23:27:15.173134 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:27:15.178542 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m23:27:15.179972 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:27:15.180954 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m23:27:15.184168 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:27:15.186877 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m23:27:15.188538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '631a6b29-30e2-4b02-bbb6-659ad6debd1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5164fd6b10>]}
[0m23:27:15.190379 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.10s]
[0m23:27:15.192474 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m23:27:15.195962 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:15.197263 [debug] [MainThread]: On master: BEGIN
[0m23:27:15.198152 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:27:15.216208 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m23:27:15.217668 [debug] [MainThread]: On master: COMMIT
[0m23:27:15.218727 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:15.219979 [debug] [MainThread]: On master: COMMIT
[0m23:27:15.222273 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:27:15.223343 [debug] [MainThread]: On master: Close
[0m23:27:15.225302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:15.226674 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m23:27:15.227872 [info ] [MainThread]: 
[0m23:27:15.229480 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m23:27:15.232319 [debug] [MainThread]: Command end result
[0m23:27:15.301765 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:27:15.307302 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:27:15.321797 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:27:15.322803 [info ] [MainThread]: 
[0m23:27:15.324259 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:27:15.325630 [info ] [MainThread]: 
[0m23:27:15.326937 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:27:15.328919 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3451986, "process_in_blocks": "19016", "process_kernel_time": 0.340548, "process_mem_max_rss": "113556", "process_out_blocks": "1600", "process_user_time": 5.490056}
[0m23:27:15.330183 [debug] [MainThread]: Command `dbt run` succeeded at 23:27:15.330018 after 4.35 seconds
[0m23:27:15.331196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5168d4d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5168d4d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516a43d8e0>]}
[0m23:27:15.332161 [debug] [MainThread]: Flushing usage events
[0m23:27:15.622715 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:53:44.552459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed65188c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed66c4ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed6518230>]}


============================== 23:53:44.561813 | 22c3a25a-06ce-4495-bf8f-2eacb0d2044b ==============================
[0m23:53:44.561813 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:53:44.563996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:53:44.880305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22c3a25a-06ce-4495-bf8f-2eacb0d2044b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed589a810>]}
[0m23:53:44.964103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22c3a25a-06ce-4495-bf8f-2eacb0d2044b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed6399100>]}
[0m23:53:44.967056 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:53:45.103069 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m23:53:45.498560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:53:45.501412 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/schema.yml
[0m23:53:45.659643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22c3a25a-06ce-4495-bf8f-2eacb0d2044b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed3f6c2f0>]}
[0m23:53:45.809890 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:53:45.821624 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:53:45.892443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22c3a25a-06ce-4495-bf8f-2eacb0d2044b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed3c8e840>]}
[0m23:53:45.893888 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m23:53:45.895460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22c3a25a-06ce-4495-bf8f-2eacb0d2044b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed3fa9340>]}
[0m23:53:45.900847 [info ] [MainThread]: 
[0m23:53:45.902363 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:53:45.903961 [info ] [MainThread]: 
[0m23:53:45.906163 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:53:45.914332 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m23:53:45.982932 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m23:53:45.984406 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m23:53:45.985826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:46.027367 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.041 seconds
[0m23:53:46.029975 [debug] [ThreadPool]: On list_destination_db: Close
[0m23:53:46.033120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m23:53:46.043326 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:53:46.044604 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m23:53:46.045689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:53:46.067591 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m23:53:46.069255 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:53:46.070487 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:53:46.076835 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m23:53:46.079511 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m23:53:46.082583 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m23:53:46.091496 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:46.093056 [debug] [MainThread]: On master: BEGIN
[0m23:53:46.094321 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:53:46.116347 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m23:53:46.118216 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:46.120481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:53:46.128162 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m23:53:46.130823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22c3a25a-06ce-4495-bf8f-2eacb0d2044b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed75bc890>]}
[0m23:53:46.132011 [debug] [MainThread]: On master: ROLLBACK
[0m23:53:46.135343 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:46.136656 [debug] [MainThread]: On master: BEGIN
[0m23:53:46.141005 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:53:46.142266 [debug] [MainThread]: On master: COMMIT
[0m23:53:46.143265 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:46.144204 [debug] [MainThread]: On master: COMMIT
[0m23:53:46.146591 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:53:46.147998 [debug] [MainThread]: On master: Close
[0m23:53:46.151273 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m23:53:46.152907 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m23:53:46.154503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m23:53:46.156140 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m23:53:46.168368 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m23:53:46.178698 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m23:53:46.238090 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m23:53:46.248838 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:53:46.249909 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m23:53:46.251203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:46.271831 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m23:53:46.272983 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:53:46.273955 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m23:53:46.277242 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m23:53:46.278621 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m23:53:46.281126 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m23:53:46.292711 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m23:53:46.296034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22c3a25a-06ce-4495-bf8f-2eacb0d2044b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed62ee9c0>]}
[0m23:53:46.297594 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m23:53:46.299905 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m23:53:46.301564 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m23:53:46.302413 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.actors' to be skipped because of status 'error'.  Reason: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql.
[0m23:53:46.303536 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m23:53:46.306193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m23:53:46.307242 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m23:53:46.311715 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m23:53:46.320392 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m23:53:46.328458 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m23:53:46.337268 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:53:46.338375 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m23:53:46.339347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:46.358832 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m23:53:46.360022 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:53:46.361611 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m23:53:46.364927 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m23:53:46.366786 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m23:53:46.369317 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m23:53:46.374339 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m23:53:46.375951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22c3a25a-06ce-4495-bf8f-2eacb0d2044b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed2d41eb0>]}
[0m23:53:46.377556 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m23:53:46.379570 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m23:53:46.381220 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m23:53:46.382065 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_actors' to be skipped because of status 'error'.  Reason: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql.
[0m23:53:46.383133 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m23:53:46.384978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m23:53:46.385952 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m23:53:46.390169 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m23:53:46.398163 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m23:53:46.404477 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m23:53:46.412843 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:53:46.413962 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m23:53:46.414938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:46.434841 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m23:53:46.436490 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:53:46.437684 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m23:53:46.440529 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m23:53:46.441691 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m23:53:46.444393 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m23:53:46.450477 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m23:53:46.452058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22c3a25a-06ce-4495-bf8f-2eacb0d2044b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed2d43050>]}
[0m23:53:46.453960 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m23:53:46.455500 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m23:53:46.456755 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.films' to be skipped because of status 'error'.  Reason: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql.
[0m23:53:46.458473 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m23:53:46.459690 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m23:53:46.460930 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m23:53:46.463249 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:46.464145 [debug] [MainThread]: On master: BEGIN
[0m23:53:46.465056 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:53:46.487983 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m23:53:46.489248 [debug] [MainThread]: On master: COMMIT
[0m23:53:46.490318 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:46.491722 [debug] [MainThread]: On master: COMMIT
[0m23:53:46.494935 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:53:46.496422 [debug] [MainThread]: On master: Close
[0m23:53:46.498343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:53:46.499888 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m23:53:46.501733 [info ] [MainThread]: 
[0m23:53:46.503734 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m23:53:46.506833 [debug] [MainThread]: Command end result
[0m23:53:46.563093 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:53:46.569322 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:53:46.582979 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:53:46.584188 [info ] [MainThread]: 
[0m23:53:46.585459 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m23:53:46.586782 [info ] [MainThread]: 
[0m23:53:46.588286 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m23:53:46.589638 [info ] [MainThread]: 
[0m23:53:46.591161 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m23:53:46.592685 [info ] [MainThread]: 
[0m23:53:46.594169 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m23:53:46.595619 [info ] [MainThread]: 
[0m23:53:46.597253 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m23:53:46.600358 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1371255, "process_in_blocks": "101440", "process_kernel_time": 0.49316, "process_mem_max_rss": "108700", "process_out_blocks": "1600", "process_user_time": 3.113681}
[0m23:53:46.601639 [debug] [MainThread]: Command `dbt run` failed at 23:53:46.601465 after 2.14 seconds
[0m23:53:46.602846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed630ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed59ecda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed799d730>]}
[0m23:53:46.603967 [debug] [MainThread]: Flushing usage events
[0m23:53:46.953450 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:55:26.700868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb667cf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb7cff650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb5d08cb0>]}


============================== 23:55:26.709133 | b0c85598-8ac9-4d5a-be8b-fff5b840431e ==============================
[0m23:55:26.709133 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:55:26.711572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:55:26.974395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0c85598-8ac9-4d5a-be8b-fff5b840431e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb5a79af0>]}
[0m23:55:27.054978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0c85598-8ac9-4d5a-be8b-fff5b840431e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb5bb05f0>]}
[0m23:55:27.057295 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:55:27.171777 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m23:55:27.483031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:55:27.484844 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:55:27.554021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0c85598-8ac9-4d5a-be8b-fff5b840431e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb5a7a4b0>]}
[0m23:55:27.718708 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:55:27.727013 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:55:27.770423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0c85598-8ac9-4d5a-be8b-fff5b840431e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb3dbf8c0>]}
[0m23:55:27.772220 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m23:55:27.773865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0c85598-8ac9-4d5a-be8b-fff5b840431e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb42819a0>]}
[0m23:55:27.779469 [info ] [MainThread]: 
[0m23:55:27.781384 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:55:27.783035 [info ] [MainThread]: 
[0m23:55:27.785181 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:55:27.792849 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m23:55:27.854350 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m23:55:27.856071 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m23:55:27.858164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:27.888725 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.031 seconds
[0m23:55:27.891706 [debug] [ThreadPool]: On list_destination_db: Close
[0m23:55:27.895224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m23:55:27.907613 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:55:27.908979 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m23:55:27.910229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:55:27.933814 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m23:55:27.935356 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:55:27.936854 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:55:27.943094 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m23:55:27.946092 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m23:55:27.949180 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m23:55:27.957804 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:27.959440 [debug] [MainThread]: On master: BEGIN
[0m23:55:27.960899 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:55:27.981875 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m23:55:27.983425 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:27.985336 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:55:27.994693 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m23:55:27.997936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0c85598-8ac9-4d5a-be8b-fff5b840431e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb42831d0>]}
[0m23:55:27.999679 [debug] [MainThread]: On master: ROLLBACK
[0m23:55:28.003662 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:28.005155 [debug] [MainThread]: On master: BEGIN
[0m23:55:28.010421 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:55:28.011736 [debug] [MainThread]: On master: COMMIT
[0m23:55:28.012708 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:28.013659 [debug] [MainThread]: On master: COMMIT
[0m23:55:28.016654 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:55:28.018073 [debug] [MainThread]: On master: Close
[0m23:55:28.021130 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m23:55:28.022988 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m23:55:28.024587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m23:55:28.025996 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m23:55:28.039260 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m23:55:28.051361 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m23:55:28.114583 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m23:55:28.126427 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:55:28.127658 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m23:55:28.128820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:28.151468 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m23:55:28.152858 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:55:28.154282 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m23:55:28.157664 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m23:55:28.159045 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m23:55:28.162268 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m23:55:28.169053 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m23:55:28.172534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0c85598-8ac9-4d5a-be8b-fff5b840431e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb65d2090>]}
[0m23:55:28.174787 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.15s]
[0m23:55:28.177791 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m23:55:28.179893 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m23:55:28.181025 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.actors' to be skipped because of status 'error'.  Reason: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql.
[0m23:55:28.182763 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m23:55:28.186417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m23:55:28.187899 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m23:55:28.193864 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m23:55:28.202800 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m23:55:28.209742 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m23:55:28.219126 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:55:28.220945 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m23:55:28.222114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:28.241127 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m23:55:28.242280 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:55:28.243347 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m23:55:28.246642 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m23:55:28.247771 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m23:55:28.251574 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m23:55:28.258531 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m23:55:28.260182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0c85598-8ac9-4d5a-be8b-fff5b840431e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb3dd8f20>]}
[0m23:55:28.261943 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m23:55:28.264481 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m23:55:28.266492 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m23:55:28.267877 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_actors' to be skipped because of status 'error'.  Reason: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql.
[0m23:55:28.269312 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m23:55:28.271393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m23:55:28.272388 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m23:55:28.276677 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m23:55:28.288623 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m23:55:28.297075 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m23:55:28.306268 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:55:28.307816 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m23:55:28.309465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:28.330872 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m23:55:28.331967 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:55:28.332972 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m23:55:28.335955 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m23:55:28.337046 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m23:55:28.339430 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m23:55:28.344476 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m23:55:28.346486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0c85598-8ac9-4d5a-be8b-fff5b840431e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb306fe90>]}
[0m23:55:28.348020 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m23:55:28.349649 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m23:55:28.351716 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.films' to be skipped because of status 'error'.  Reason: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql.
[0m23:55:28.353426 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m23:55:28.354430 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m23:55:28.355637 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m23:55:28.358089 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:28.359238 [debug] [MainThread]: On master: BEGIN
[0m23:55:28.360147 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:55:28.378536 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m23:55:28.380121 [debug] [MainThread]: On master: COMMIT
[0m23:55:28.381371 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:28.382562 [debug] [MainThread]: On master: COMMIT
[0m23:55:28.385819 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:55:28.387029 [debug] [MainThread]: On master: Close
[0m23:55:28.388342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:55:28.389677 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m23:55:28.390912 [info ] [MainThread]: 
[0m23:55:28.392450 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m23:55:28.395972 [debug] [MainThread]: Command end result
[0m23:55:28.457410 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:55:28.462768 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:55:28.476505 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:55:28.477556 [info ] [MainThread]: 
[0m23:55:28.478942 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m23:55:28.480439 [info ] [MainThread]: 
[0m23:55:28.482393 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m23:55:28.483819 [info ] [MainThread]: 
[0m23:55:28.485553 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m23:55:28.487062 [info ] [MainThread]: 
[0m23:55:28.488758 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m23:55:28.490418 [info ] [MainThread]: 
[0m23:55:28.491840 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m23:55:28.493821 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8881212, "process_in_blocks": "0", "process_kernel_time": 0.279245, "process_mem_max_rss": "108480", "process_out_blocks": "1600", "process_user_time": 3.131542}
[0m23:55:28.495107 [debug] [MainThread]: Command `dbt run` failed at 23:55:28.494924 after 1.89 seconds
[0m23:55:28.496704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb7a7c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb5b0d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb65f5040>]}
[0m23:55:28.498041 [debug] [MainThread]: Flushing usage events
[0m23:55:28.819440 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:08:57.110619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bacc773b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8badd5a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bae7d0530>]}


============================== 00:08:57.145922 | 37744a37-646f-4c25-b931-7c842949547b ==============================
[0m00:08:57.145922 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:08:57.148314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:08:57.448772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37744a37-646f-4c25-b931-7c842949547b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bac8cacc0>]}
[0m00:08:57.541013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37744a37-646f-4c25-b931-7c842949547b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bad4e0980>]}
[0m00:08:57.543336 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:08:57.664616 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m00:08:58.021553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:08:58.023211 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:08:58.097109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37744a37-646f-4c25-b931-7c842949547b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8baafb54c0>]}
[0m00:08:58.257921 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:08:58.267185 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:08:58.314449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37744a37-646f-4c25-b931-7c842949547b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8baade8f50>]}
[0m00:08:58.316133 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m00:08:58.317547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37744a37-646f-4c25-b931-7c842949547b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8baad12570>]}
[0m00:08:58.322526 [info ] [MainThread]: 
[0m00:08:58.324445 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:08:58.326398 [info ] [MainThread]: 
[0m00:08:58.329023 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:08:58.337882 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m00:08:58.401515 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m00:08:58.403175 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m00:08:58.404891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:58.437730 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.033 seconds
[0m00:08:58.440558 [debug] [ThreadPool]: On list_destination_db: Close
[0m00:08:58.443847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m00:08:58.454501 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:08:58.455771 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m00:08:58.456908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:58.479053 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m00:08:58.480291 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:08:58.481670 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:08:58.488094 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m00:08:58.490638 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m00:08:58.493780 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m00:08:58.502582 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:58.503928 [debug] [MainThread]: On master: BEGIN
[0m00:08:58.505488 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:08:58.528073 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m00:08:58.529557 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:58.531118 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:08:58.538164 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m00:08:58.541079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37744a37-646f-4c25-b931-7c842949547b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8baade9370>]}
[0m00:08:58.542314 [debug] [MainThread]: On master: ROLLBACK
[0m00:08:58.545175 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:58.546278 [debug] [MainThread]: On master: BEGIN
[0m00:08:58.549844 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:08:58.550957 [debug] [MainThread]: On master: COMMIT
[0m00:08:58.551918 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:58.552781 [debug] [MainThread]: On master: COMMIT
[0m00:08:58.555083 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:08:58.556401 [debug] [MainThread]: On master: Close
[0m00:08:58.559607 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m00:08:58.561136 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m00:08:58.562539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m00:08:58.563818 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m00:08:58.575766 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m00:08:58.587351 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m00:08:58.651273 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m00:08:58.663385 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:08:58.664404 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m00:08:58.665343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:58.687737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m00:08:58.689455 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:08:58.690931 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m00:08:58.697840 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m00:08:58.699313 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m00:08:58.701933 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m00:08:58.708533 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m00:08:58.711999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37744a37-646f-4c25-b931-7c842949547b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bad31e990>]}
[0m00:08:58.714347 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.15s]
[0m00:08:58.716430 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m00:08:58.718282 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m00:08:58.719251 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.actors' to be skipped because of status 'error'.  Reason: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql.
[0m00:08:58.720691 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m00:08:58.724141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m00:08:58.725317 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m00:08:58.730856 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m00:08:58.738774 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m00:08:58.746320 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m00:08:58.756535 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:08:58.757662 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m00:08:58.758909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:58.779451 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m00:08:58.780572 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:08:58.781564 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m00:08:58.784306 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m00:08:58.785408 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m00:08:58.787953 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m00:08:58.793535 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m00:08:58.795116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37744a37-646f-4c25-b931-7c842949547b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bacda7fe0>]}
[0m00:08:58.796700 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m00:08:58.798595 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m00:08:58.800085 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m00:08:58.801001 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_actors' to be skipped because of status 'error'.  Reason: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql.
[0m00:08:58.802124 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m00:08:58.804104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m00:08:58.805157 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m00:08:58.810903 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m00:08:58.820020 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m00:08:58.826881 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m00:08:58.862975 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:08:58.864429 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m00:08:58.872229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:58.892476 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m00:08:58.893619 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:08:58.894710 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m00:08:58.897635 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m00:08:58.898718 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m00:08:58.901165 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m00:08:58.908943 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m00:08:58.910511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37744a37-646f-4c25-b931-7c842949547b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ba9da7c80>]}
[0m00:08:58.912679 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.11s]
[0m00:08:58.915212 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m00:08:58.917563 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.films' to be skipped because of status 'error'.  Reason: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql.
[0m00:08:58.920602 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m00:08:58.922769 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m00:08:58.924789 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m00:08:58.927888 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:58.929496 [debug] [MainThread]: On master: BEGIN
[0m00:08:58.931409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:08:58.951883 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m00:08:58.953528 [debug] [MainThread]: On master: COMMIT
[0m00:08:58.954565 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:58.955570 [debug] [MainThread]: On master: COMMIT
[0m00:08:58.957964 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:08:58.958985 [debug] [MainThread]: On master: Close
[0m00:08:58.960342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:08:58.961589 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m00:08:58.962798 [info ] [MainThread]: 
[0m00:08:58.964131 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m00:08:58.966882 [debug] [MainThread]: Command end result
[0m00:08:59.021173 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:08:59.026793 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:08:59.039589 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m00:08:59.040669 [info ] [MainThread]: 
[0m00:08:59.042115 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m00:08:59.043471 [info ] [MainThread]: 
[0m00:08:59.044961 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m00:08:59.046491 [info ] [MainThread]: 
[0m00:08:59.048520 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m00:08:59.050054 [info ] [MainThread]: 
[0m00:08:59.051660 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m00:08:59.053040 [info ] [MainThread]: 
[0m00:08:59.054358 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m00:08:59.056476 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0671484, "process_in_blocks": "0", "process_kernel_time": 0.300391, "process_mem_max_rss": "108656", "process_out_blocks": "1600", "process_user_time": 3.92447}
[0m00:08:59.057723 [debug] [MainThread]: Command `dbt run` failed at 00:08:59.057563 after 2.07 seconds
[0m00:08:59.058675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bacc773b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8badb73c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bac817b90>]}
[0m00:08:59.059588 [debug] [MainThread]: Flushing usage events
[0m00:08:59.537289 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:16:14.882083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f07f89670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f07f43230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f08120500>]}


============================== 00:16:14.890541 | 01b9d7bd-a7f4-42b2-a367-f95e9f6c72a6 ==============================
[0m00:16:14.890541 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:16:14.892770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/root', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m00:16:15.189448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01b9d7bd-a7f4-42b2-a367-f95e9f6c72a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f07d8a630>]}
[0m00:16:15.280710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01b9d7bd-a7f4-42b2-a367-f95e9f6c72a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f084abd40>]}
[0m00:16:15.282827 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:16:15.403218 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m00:16:15.724096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:16:15.725989 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:16:15.806553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01b9d7bd-a7f4-42b2-a367-f95e9f6c72a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f06457b90>]}
[0m00:16:15.972961 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:16:15.982038 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:16:16.023968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01b9d7bd-a7f4-42b2-a367-f95e9f6c72a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f06270c80>]}
[0m00:16:16.025546 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m00:16:16.027118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01b9d7bd-a7f4-42b2-a367-f95e9f6c72a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f087f66f0>]}
[0m00:16:16.032400 [info ] [MainThread]: 
[0m00:16:16.034138 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:16:16.035818 [info ] [MainThread]: 
[0m00:16:16.038385 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:16:16.046168 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m00:16:16.107789 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m00:16:16.109399 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m00:16:16.110824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:16.142902 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.032 seconds
[0m00:16:16.145674 [debug] [ThreadPool]: On list_destination_db: Close
[0m00:16:16.148966 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m00:16:16.160495 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:16:16.161652 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m00:16:16.162958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:16.185805 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m00:16:16.187082 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:16:16.188216 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:16:16.194765 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m00:16:16.197895 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m00:16:16.200798 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m00:16:16.211923 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:16.214276 [debug] [MainThread]: On master: BEGIN
[0m00:16:16.215805 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:16:16.235467 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m00:16:16.236569 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:16.237838 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:16:16.245823 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m00:16:16.249333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01b9d7bd-a7f4-42b2-a367-f95e9f6c72a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f064036e0>]}
[0m00:16:16.250838 [debug] [MainThread]: On master: ROLLBACK
[0m00:16:16.253594 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:16.254780 [debug] [MainThread]: On master: BEGIN
[0m00:16:16.258993 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:16:16.260399 [debug] [MainThread]: On master: COMMIT
[0m00:16:16.261522 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:16.262691 [debug] [MainThread]: On master: COMMIT
[0m00:16:16.265486 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:16:16.266821 [debug] [MainThread]: On master: Close
[0m00:16:16.271318 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m00:16:16.273320 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m00:16:16.275153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m00:16:16.276713 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m00:16:16.289782 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m00:16:16.297755 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m00:16:16.360332 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m00:16:16.371634 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:16:16.372928 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m00:16:16.374204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:16.393981 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m00:16:16.395097 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:16:16.396144 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m00:16:16.398942 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m00:16:16.400064 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m00:16:16.402282 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m00:16:16.408561 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m00:16:16.411822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01b9d7bd-a7f4-42b2-a367-f95e9f6c72a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f087c2f60>]}
[0m00:16:16.413608 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m00:16:16.415263 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m00:16:16.416410 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m00:16:16.417171 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.actors' to be skipped because of status 'error'.  Reason: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql.
[0m00:16:16.418474 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m00:16:16.421343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m00:16:16.422387 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m00:16:16.426739 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m00:16:16.434935 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m00:16:16.440414 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m00:16:16.447868 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:16:16.449039 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m00:16:16.453402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:16.478419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m00:16:16.479896 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:16:16.481106 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m00:16:16.484427 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m00:16:16.486415 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m00:16:16.489568 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m00:16:16.497544 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m00:16:16.499361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01b9d7bd-a7f4-42b2-a367-f95e9f6c72a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0536dc70>]}
[0m00:16:16.501123 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.08s]
[0m00:16:16.503204 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m00:16:16.504777 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m00:16:16.505777 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_actors' to be skipped because of status 'error'.  Reason: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql.
[0m00:16:16.506894 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m00:16:16.509305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m00:16:16.510735 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m00:16:16.516312 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m00:16:16.524469 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m00:16:16.530285 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m00:16:16.537892 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:16:16.539382 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m00:16:16.540401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:16.563908 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m00:16:16.565406 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:16:16.566875 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m00:16:16.570392 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m00:16:16.571830 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m00:16:16.575276 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m00:16:16.581481 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m00:16:16.583074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01b9d7bd-a7f4-42b2-a367-f95e9f6c72a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f05273e60>]}
[0m00:16:16.584823 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m00:16:16.586555 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m00:16:16.588239 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.films' to be skipped because of status 'error'.  Reason: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql.
[0m00:16:16.590408 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m00:16:16.591744 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m00:16:16.593089 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m00:16:16.595880 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:16.597095 [debug] [MainThread]: On master: BEGIN
[0m00:16:16.598255 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:16:16.617584 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m00:16:16.618829 [debug] [MainThread]: On master: COMMIT
[0m00:16:16.619865 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:16.620859 [debug] [MainThread]: On master: COMMIT
[0m00:16:16.623070 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:16:16.624217 [debug] [MainThread]: On master: Close
[0m00:16:16.625464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:16.626614 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m00:16:16.627749 [info ] [MainThread]: 
[0m00:16:16.629592 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m00:16:16.632041 [debug] [MainThread]: Command end result
[0m00:16:16.684745 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:16:16.690359 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:16:16.703042 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m00:16:16.704262 [info ] [MainThread]: 
[0m00:16:16.705709 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m00:16:16.707349 [info ] [MainThread]: 
[0m00:16:16.709111 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m00:16:16.710669 [info ] [MainThread]: 
[0m00:16:16.712194 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m00:16:16.713512 [info ] [MainThread]: 
[0m00:16:16.715013 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m00:16:16.716495 [info ] [MainThread]: 
[0m00:16:16.718078 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m00:16:16.720584 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9315265, "process_in_blocks": "0", "process_kernel_time": 0.341086, "process_mem_max_rss": "110224", "process_out_blocks": "1600", "process_user_time": 3.268748}
[0m00:16:16.722001 [debug] [MainThread]: Command `dbt run` failed at 00:16:16.721816 after 1.93 seconds
[0m00:16:16.723035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f090b9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f08131430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f087c0a70>]}
[0m00:16:16.724040 [debug] [MainThread]: Flushing usage events
[0m00:16:16.993623 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:23:31.580710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92402d85f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9241e1f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9240a88500>]}


============================== 00:23:31.590574 | 4e13d5a5-f037-4463-9bbc-32fe09d88172 ==============================
[0m00:23:31.590574 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:23:31.592448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:23:31.935395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e13d5a5-f037-4463-9bbc-32fe09d88172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f924021b530>]}
[0m00:23:32.022522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e13d5a5-f037-4463-9bbc-32fe09d88172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f923e98c680>]}
[0m00:23:32.025710 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:23:32.148982 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m00:23:32.502362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:23:32.503957 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:23:32.576266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e13d5a5-f037-4463-9bbc-32fe09d88172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f923ea442c0>]}
[0m00:23:32.735220 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:23:32.745549 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:23:32.811590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e13d5a5-f037-4463-9bbc-32fe09d88172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f923e776420>]}
[0m00:23:32.813356 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m00:23:32.814895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e13d5a5-f037-4463-9bbc-32fe09d88172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92407af0e0>]}
[0m00:23:32.819031 [info ] [MainThread]: 
[0m00:23:32.820681 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:23:32.822239 [info ] [MainThread]: 
[0m00:23:32.824006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:23:32.832145 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m00:23:32.896686 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m00:23:32.898228 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m00:23:32.899696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:32.937687 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.038 seconds
[0m00:23:32.940229 [debug] [ThreadPool]: On list_destination_db: Close
[0m00:23:32.943296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m00:23:32.953180 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:23:32.954586 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m00:23:32.956053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:32.978326 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m00:23:32.979670 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:23:32.980727 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:23:32.986713 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m00:23:32.990089 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m00:23:32.993210 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m00:23:33.002149 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:33.003621 [debug] [MainThread]: On master: BEGIN
[0m00:23:33.004878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:23:33.024219 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m00:23:33.025183 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:33.026249 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:23:33.032082 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m00:23:33.034808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e13d5a5-f037-4463-9bbc-32fe09d88172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f923e776420>]}
[0m00:23:33.036052 [debug] [MainThread]: On master: ROLLBACK
[0m00:23:33.039294 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:33.040373 [debug] [MainThread]: On master: BEGIN
[0m00:23:33.044257 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:23:33.045288 [debug] [MainThread]: On master: COMMIT
[0m00:23:33.046111 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:33.046942 [debug] [MainThread]: On master: COMMIT
[0m00:23:33.048927 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:23:33.049806 [debug] [MainThread]: On master: Close
[0m00:23:33.053059 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m00:23:33.054444 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m00:23:33.055492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m00:23:33.056362 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m00:23:33.068041 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m00:23:33.078308 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m00:23:33.137905 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m00:23:33.148662 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:23:33.150005 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m00:23:33.151056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:33.171906 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m00:23:33.172846 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:23:33.173661 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m00:23:33.176669 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m00:23:33.177756 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m00:23:33.179882 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m00:23:33.189782 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m00:23:33.192777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e13d5a5-f037-4463-9bbc-32fe09d88172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9240d9ed50>]}
[0m00:23:33.194193 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m00:23:33.195634 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m00:23:33.196715 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m00:23:33.197529 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.actors' to be skipped because of status 'error'.  Reason: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql.
[0m00:23:33.198598 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m00:23:33.201118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m00:23:33.202128 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m00:23:33.206337 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m00:23:33.215891 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m00:23:33.221046 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m00:23:33.229445 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:23:33.230523 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m00:23:33.231485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:33.253147 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m00:23:33.254382 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:23:33.256042 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m00:23:33.260848 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m00:23:33.262444 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m00:23:33.266040 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m00:23:33.272719 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m00:23:33.274484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e13d5a5-f037-4463-9bbc-32fe09d88172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f923e592a20>]}
[0m00:23:33.276368 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m00:23:33.278245 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m00:23:33.279888 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m00:23:33.280767 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_actors' to be skipped because of status 'error'.  Reason: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql.
[0m00:23:33.282419 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m00:23:33.285209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m00:23:33.286488 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m00:23:33.290840 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m00:23:33.299650 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m00:23:33.304752 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m00:23:33.313398 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:23:33.314436 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m00:23:33.315269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:33.336103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m00:23:33.337613 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:23:33.339202 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m00:23:33.343151 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m00:23:33.344819 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m00:23:33.348734 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m00:23:33.354093 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m00:23:33.355458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e13d5a5-f037-4463-9bbc-32fe09d88172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f923da08f50>]}
[0m00:23:33.356940 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m00:23:33.358747 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m00:23:33.360207 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.films' to be skipped because of status 'error'.  Reason: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql.
[0m00:23:33.362695 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m00:23:33.364178 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m00:23:33.365580 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m00:23:33.368272 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:33.369357 [debug] [MainThread]: On master: BEGIN
[0m00:23:33.370409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:23:33.390273 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m00:23:33.391371 [debug] [MainThread]: On master: COMMIT
[0m00:23:33.392329 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:33.393238 [debug] [MainThread]: On master: COMMIT
[0m00:23:33.396047 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:23:33.397309 [debug] [MainThread]: On master: Close
[0m00:23:33.398629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:23:33.399888 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m00:23:33.401144 [info ] [MainThread]: 
[0m00:23:33.402511 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m00:23:33.405305 [debug] [MainThread]: Command end result
[0m00:23:33.468807 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:23:33.477396 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:23:33.491771 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m00:23:33.493052 [info ] [MainThread]: 
[0m00:23:33.494467 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m00:23:33.495812 [info ] [MainThread]: 
[0m00:23:33.497192 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m00:23:33.498590 [info ] [MainThread]: 
[0m00:23:33.500166 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m00:23:33.501474 [info ] [MainThread]: 
[0m00:23:33.502732 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m00:23:33.503977 [info ] [MainThread]: 
[0m00:23:33.505189 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m00:23:33.507730 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0225904, "process_in_blocks": "101440", "process_kernel_time": 0.348167, "process_mem_max_rss": "109260", "process_out_blocks": "1600", "process_user_time": 2.959426}
[0m00:23:33.509183 [debug] [MainThread]: Command `dbt run` failed at 00:23:33.509036 after 2.02 seconds
[0m00:23:33.510322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9240830590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f923ea6caa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f923ea6ce00>]}
[0m00:23:33.511429 [debug] [MainThread]: Flushing usage events
[0m00:23:33.869838 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:23:43.485132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1238810fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1236ce9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1238794530>]}


============================== 00:23:43.489877 | 45243087-7d49-49cf-961d-3538692f686c ==============================
[0m00:23:43.489877 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:23:43.491497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:23:43.760641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45243087-7d49-49cf-961d-3538692f686c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1236851940>]}
[0m00:23:43.860465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45243087-7d49-49cf-961d-3538692f686c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12369bcd70>]}
[0m00:23:43.862897 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:23:43.984041 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m00:23:44.325050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:23:44.326305 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:23:44.408794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45243087-7d49-49cf-961d-3538692f686c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1236ceb350>]}
[0m00:23:44.573544 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:23:44.580288 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:23:44.611753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45243087-7d49-49cf-961d-3538692f686c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1234e48230>]}
[0m00:23:44.613694 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m00:23:44.615470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45243087-7d49-49cf-961d-3538692f686c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1236ce9a90>]}
[0m00:23:44.620393 [info ] [MainThread]: 
[0m00:23:44.622167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:23:44.624057 [info ] [MainThread]: 
[0m00:23:44.626175 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:23:44.634425 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m00:23:44.694601 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m00:23:44.696127 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m00:23:44.697316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:44.720356 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.023 seconds
[0m00:23:44.722699 [debug] [ThreadPool]: On list_destination_db: Close
[0m00:23:44.725666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m00:23:44.736126 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:23:44.737480 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m00:23:44.738699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:44.758171 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m00:23:44.759275 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:23:44.760782 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:23:44.766925 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m00:23:44.769592 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m00:23:44.771783 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m00:23:44.781787 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:44.783032 [debug] [MainThread]: On master: BEGIN
[0m00:23:44.784351 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:23:44.802008 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m00:23:44.803049 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:44.804290 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:23:44.811532 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m00:23:44.814018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45243087-7d49-49cf-961d-3538692f686c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1234e9f020>]}
[0m00:23:44.815307 [debug] [MainThread]: On master: ROLLBACK
[0m00:23:44.817763 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:44.818806 [debug] [MainThread]: On master: BEGIN
[0m00:23:44.822525 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:23:44.823619 [debug] [MainThread]: On master: COMMIT
[0m00:23:44.824533 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:44.825426 [debug] [MainThread]: On master: COMMIT
[0m00:23:44.827723 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:23:44.828756 [debug] [MainThread]: On master: Close
[0m00:23:44.832138 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m00:23:44.833647 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m00:23:44.834990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m00:23:44.836096 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m00:23:44.849319 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m00:23:44.856639 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m00:23:44.919100 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m00:23:44.926897 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:23:44.928135 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m00:23:44.929051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:44.947353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m00:23:44.948462 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:23:44.949501 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m00:23:44.953221 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.003 seconds
[0m00:23:44.964850 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:23:44.965978 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m00:23:44.969170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:23:44.975132 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:23:44.976158 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m00:23:44.978595 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:23:45.010045 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m00:23:45.011147 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:23:45.012168 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m00:23:45.018944 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m00:23:45.028800 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m00:23:45.038918 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:23:45.040268 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m00:23:45.046870 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m00:23:45.052218 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m00:23:45.055206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45243087-7d49-49cf-961d-3538692f686c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f123850e750>]}
[0m00:23:45.057058 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.22s]
[0m00:23:45.058669 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m00:23:45.059774 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m00:23:45.061147 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m00:23:45.062571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m00:23:45.063637 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m00:23:45.068567 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m00:23:45.076548 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m00:23:45.082412 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m00:23:45.089864 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:23:45.091235 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m00:23:45.092241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:45.109637 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m00:23:45.110694 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:23:45.111706 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m00:23:45.115428 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.003 seconds
[0m00:23:45.120855 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:23:45.122428 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m00:23:45.126840 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:23:45.132377 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:23:45.133839 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m00:23:45.136972 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:23:45.139844 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m00:23:45.141001 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:23:45.142286 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m00:23:45.148956 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m00:23:45.154491 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m00:23:45.155909 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:23:45.156921 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m00:23:45.161951 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:23:45.164858 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m00:23:45.166447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45243087-7d49-49cf-961d-3538692f686c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f122e451e50>]}
[0m00:23:45.168198 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.10s]
[0m00:23:45.170233 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m00:23:45.171836 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m00:23:45.173741 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m00:23:45.175194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m00:23:45.176542 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m00:23:45.181073 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m00:23:45.187879 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m00:23:45.193034 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m00:23:45.200274 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:23:45.201418 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m00:23:45.202425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:45.219492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m00:23:45.220589 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:23:45.221661 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m00:23:45.225600 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.003 seconds
[0m00:23:45.231028 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:23:45.232470 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m00:23:45.235128 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:23:45.240017 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:23:45.241422 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m00:23:45.244665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:23:45.247886 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m00:23:45.249225 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:23:45.250324 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m00:23:45.257142 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m00:23:45.261618 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m00:23:45.263044 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:23:45.264077 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m00:23:45.269952 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m00:23:45.272623 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m00:23:45.274255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45243087-7d49-49cf-961d-3538692f686c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f122e4295b0>]}
[0m00:23:45.276030 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.10s]
[0m00:23:45.278093 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m00:23:45.280227 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m00:23:45.281376 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m00:23:45.282635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m00:23:45.283602 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m00:23:45.289650 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m00:23:45.298391 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m00:23:45.304766 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m00:23:45.313895 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:23:45.315498 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m00:23:45.316746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:45.342399 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m00:23:45.343579 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:23:45.345203 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m00:23:45.351266 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.005 seconds
[0m00:23:45.356382 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:23:45.357559 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m00:23:45.360470 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:23:45.363173 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m00:23:45.364237 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:23:45.365223 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m00:23:45.369084 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m00:23:45.373597 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m00:23:45.375642 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:23:45.376941 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m00:23:45.380387 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m00:23:45.383244 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m00:23:45.384942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45243087-7d49-49cf-961d-3538692f686c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1234c91df0>]}
[0m00:23:45.386665 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.10s]
[0m00:23:45.389060 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m00:23:45.392266 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:45.393503 [debug] [MainThread]: On master: BEGIN
[0m00:23:45.394670 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:23:45.413188 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m00:23:45.414224 [debug] [MainThread]: On master: COMMIT
[0m00:23:45.415252 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:45.416237 [debug] [MainThread]: On master: COMMIT
[0m00:23:45.418857 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:23:45.420389 [debug] [MainThread]: On master: Close
[0m00:23:45.421855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:23:45.423324 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m00:23:45.424613 [info ] [MainThread]: 
[0m00:23:45.426065 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m00:23:45.428954 [debug] [MainThread]: Command end result
[0m00:23:45.484200 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:23:45.489225 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:23:45.503633 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m00:23:45.504840 [info ] [MainThread]: 
[0m00:23:45.506475 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:23:45.508042 [info ] [MainThread]: 
[0m00:23:45.509751 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:23:45.512344 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1598961, "process_in_blocks": "0", "process_kernel_time": 0.275568, "process_mem_max_rss": "107744", "process_out_blocks": "0", "process_user_time": 3.267458}
[0m00:23:45.513797 [debug] [MainThread]: Command `dbt run` succeeded at 00:23:45.513610 after 2.16 seconds
[0m00:23:45.515371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1236a51820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1236880fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f122fed7a10>]}
[0m00:23:45.517216 [debug] [MainThread]: Flushing usage events
[0m00:23:45.698083 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:40:31.237138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cd252f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cd3f783e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cd258de50>]}


============================== 00:40:31.246769 | e35d8be2-569e-4c28-97fd-30211e8e90da ==============================
[0m00:40:31.246769 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:40:31.248641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:40:31.598972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e35d8be2-569e-4c28-97fd-30211e8e90da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cd06e4c20>]}
[0m00:40:31.688189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e35d8be2-569e-4c28-97fd-30211e8e90da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cd34af7d0>]}
[0m00:40:31.691186 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:40:31.820273 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m00:40:32.340762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:40:32.342244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:40:32.513189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e35d8be2-569e-4c28-97fd-30211e8e90da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cd073f980>]}
[0m00:40:32.707261 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:40:32.715923 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:40:32.774423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e35d8be2-569e-4c28-97fd-30211e8e90da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cd02b6c30>]}
[0m00:40:32.775880 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m00:40:32.777475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e35d8be2-569e-4c28-97fd-30211e8e90da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cd21f90d0>]}
[0m00:40:32.782921 [info ] [MainThread]: 
[0m00:40:32.784442 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:40:32.785910 [info ] [MainThread]: 
[0m00:40:32.787856 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:40:32.796938 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m00:40:32.863213 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m00:40:32.864884 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m00:40:32.866315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:40:32.904558 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.038 seconds
[0m00:40:32.909613 [debug] [ThreadPool]: On list_destination_db: Close
[0m00:40:32.913962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m00:40:32.925465 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:40:32.927081 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m00:40:32.928423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:40:32.948778 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m00:40:32.949922 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:40:32.950844 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:40:32.956491 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m00:40:32.958827 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m00:40:32.961028 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m00:40:32.969940 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:32.971250 [debug] [MainThread]: On master: BEGIN
[0m00:40:32.972272 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:40:32.992233 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m00:40:32.993774 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:32.995417 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:40:33.003545 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m00:40:33.006837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e35d8be2-569e-4c28-97fd-30211e8e90da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cd073f8f0>]}
[0m00:40:33.008521 [debug] [MainThread]: On master: ROLLBACK
[0m00:40:33.011683 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:33.012746 [debug] [MainThread]: On master: BEGIN
[0m00:40:33.017166 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:40:33.018317 [debug] [MainThread]: On master: COMMIT
[0m00:40:33.019511 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:33.020742 [debug] [MainThread]: On master: COMMIT
[0m00:40:33.023045 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:40:33.024163 [debug] [MainThread]: On master: Close
[0m00:40:33.028031 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m00:40:33.029901 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m00:40:33.031715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m00:40:33.033257 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m00:40:33.047042 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m00:40:33.054501 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m00:40:33.116666 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m00:40:33.127624 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:40:33.128612 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m00:40:33.129449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:33.150741 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m00:40:33.151883 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:40:33.152939 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m00:40:33.156538 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m00:40:33.157666 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m00:40:33.160034 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m00:40:33.170059 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m00:40:33.172977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e35d8be2-569e-4c28-97fd-30211e8e90da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cd2ac6270>]}
[0m00:40:33.174552 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m00:40:33.176343 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m00:40:33.177716 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m00:40:33.178749 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.actors' to be skipped because of status 'error'.  Reason: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql.
[0m00:40:33.180326 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m00:40:33.184042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m00:40:33.185456 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m00:40:33.190039 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m00:40:33.199862 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m00:40:33.205961 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m00:40:33.214418 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:40:33.215521 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m00:40:33.216514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:33.238397 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m00:40:33.239753 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:40:33.240997 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m00:40:33.244207 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m00:40:33.245413 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m00:40:33.248114 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m00:40:33.255277 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m00:40:33.257049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e35d8be2-569e-4c28-97fd-30211e8e90da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cd0334890>]}
[0m00:40:33.258668 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m00:40:33.260944 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m00:40:33.262336 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m00:40:33.263104 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_actors' to be skipped because of status 'error'.  Reason: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql.
[0m00:40:33.264243 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m00:40:33.266154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m00:40:33.267114 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m00:40:33.271286 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m00:40:33.280610 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m00:40:33.286476 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m00:40:33.295855 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:40:33.297424 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m00:40:33.298875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:33.324540 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m00:40:33.325803 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:40:33.327302 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m00:40:33.331559 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m00:40:33.333147 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m00:40:33.336267 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m00:40:33.341594 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m00:40:33.342946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e35d8be2-569e-4c28-97fd-30211e8e90da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ccf553c80>]}
[0m00:40:33.344824 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.08s]
[0m00:40:33.346972 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m00:40:33.348966 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.films' to be skipped because of status 'error'.  Reason: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql.
[0m00:40:33.351202 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m00:40:33.352574 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m00:40:33.353978 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m00:40:33.356830 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:33.358249 [debug] [MainThread]: On master: BEGIN
[0m00:40:33.359538 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:40:33.380417 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m00:40:33.381657 [debug] [MainThread]: On master: COMMIT
[0m00:40:33.382811 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:33.384115 [debug] [MainThread]: On master: COMMIT
[0m00:40:33.387050 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:40:33.388283 [debug] [MainThread]: On master: Close
[0m00:40:33.390255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:40:33.391613 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m00:40:33.392999 [info ] [MainThread]: 
[0m00:40:33.394676 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m00:40:33.397323 [debug] [MainThread]: Command end result
[0m00:40:33.457924 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:40:33.464714 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:40:33.478663 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m00:40:33.479881 [info ] [MainThread]: 
[0m00:40:33.481585 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m00:40:33.483437 [info ] [MainThread]: 
[0m00:40:33.485394 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m00:40:33.487102 [info ] [MainThread]: 
[0m00:40:33.489024 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m00:40:33.490538 [info ] [MainThread]: 
[0m00:40:33.492401 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m00:40:33.494271 [info ] [MainThread]: 
[0m00:40:33.495993 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m00:40:33.499525 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3602147, "process_in_blocks": "101600", "process_kernel_time": 0.436017, "process_mem_max_rss": "108192", "process_out_blocks": "1600", "process_user_time": 3.410623}
[0m00:40:33.501353 [debug] [MainThread]: Command `dbt run` failed at 00:40:33.501156 after 2.36 seconds
[0m00:40:33.502506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cd2b8f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cd1f8ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cd1f6e7e0>]}
[0m00:40:33.503627 [debug] [MainThread]: Flushing usage events
[0m00:40:33.774717 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:41:03.588997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b6d85c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b718cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b6a34c20>]}


============================== 00:41:03.593754 | 4cad83a4-58ef-4811-bcd5-f3700b399eaf ==============================
[0m00:41:03.593754 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:41:03.595626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:41:03.100434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cad83a4-58ef-4811-bcd5-f3700b399eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b622af00>]}
[0m00:41:03.209525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cad83a4-58ef-4811-bcd5-f3700b399eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b4550950>]}
[0m00:41:03.212303 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:41:03.350109 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m00:41:03.715325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:41:03.716950 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:41:03.801834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cad83a4-58ef-4811-bcd5-f3700b399eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b5fb7980>]}
[0m00:41:03.971722 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:41:03.981260 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:41:04.015209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cad83a4-58ef-4811-bcd5-f3700b399eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b4153770>]}
[0m00:41:04.016948 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m00:41:04.018471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cad83a4-58ef-4811-bcd5-f3700b399eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b45e1190>]}
[0m00:41:04.023077 [info ] [MainThread]: 
[0m00:41:04.024914 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:41:04.026498 [info ] [MainThread]: 
[0m00:41:04.028244 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:41:04.035023 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m00:41:04.098494 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m00:41:04.100310 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m00:41:04.101646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:41:04.128365 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.027 seconds
[0m00:41:04.130798 [debug] [ThreadPool]: On list_destination_db: Close
[0m00:41:04.134192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m00:41:04.145124 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:41:04.146443 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m00:41:04.147704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:41:04.170422 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m00:41:04.171630 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:41:04.172745 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:41:04.178962 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m00:41:04.181817 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m00:41:04.184840 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m00:41:04.194898 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:04.196462 [debug] [MainThread]: On master: BEGIN
[0m00:41:04.197728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:41:04.217706 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m00:41:04.218765 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:04.219950 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:41:04.225910 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m00:41:04.228628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cad83a4-58ef-4811-bcd5-f3700b399eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b45ecc20>]}
[0m00:41:04.230103 [debug] [MainThread]: On master: ROLLBACK
[0m00:41:04.233756 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:04.235354 [debug] [MainThread]: On master: BEGIN
[0m00:41:04.239458 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:41:04.240512 [debug] [MainThread]: On master: COMMIT
[0m00:41:04.241489 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:04.242559 [debug] [MainThread]: On master: COMMIT
[0m00:41:04.244748 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:41:04.245691 [debug] [MainThread]: On master: Close
[0m00:41:04.248443 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m00:41:04.250003 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m00:41:04.251372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m00:41:04.252257 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m00:41:04.264959 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m00:41:04.274297 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m00:41:04.336653 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m00:41:04.345752 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:04.346780 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m00:41:04.347672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:04.368734 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m00:41:04.369972 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:04.371085 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m00:41:04.375440 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.003 seconds
[0m00:41:04.386240 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:04.387698 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m00:41:04.391502 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:41:04.398138 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:04.399728 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m00:41:04.403225 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:41:04.433510 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m00:41:04.435424 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:04.437260 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m00:41:04.446137 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m00:41:04.456772 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m00:41:04.465211 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:04.466879 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m00:41:04.475662 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m00:41:04.480352 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m00:41:04.484339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cad83a4-58ef-4811-bcd5-f3700b399eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b697a1e0>]}
[0m00:41:04.486406 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.23s]
[0m00:41:04.488258 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m00:41:04.489731 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m00:41:04.491117 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m00:41:04.492569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m00:41:04.493930 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m00:41:04.498822 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m00:41:04.507679 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m00:41:04.513018 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m00:41:04.522575 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:04.523651 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m00:41:04.524580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:04.541481 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m00:41:04.542725 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:04.543785 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m00:41:04.547176 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.002 seconds
[0m00:41:04.551729 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:04.552894 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m00:41:04.555747 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:41:04.560984 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:04.562850 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m00:41:04.567566 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:41:04.570621 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m00:41:04.571994 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:04.573331 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m00:41:04.581622 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m00:41:04.588520 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m00:41:04.590226 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:04.591563 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m00:41:04.597409 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m00:41:04.600000 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m00:41:04.601560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cad83a4-58ef-4811-bcd5-f3700b399eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b33ee240>]}
[0m00:41:04.603587 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.11s]
[0m00:41:04.605850 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m00:41:04.607422 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m00:41:04.609271 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m00:41:04.610741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m00:41:04.612094 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m00:41:04.616918 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m00:41:04.628573 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m00:41:04.634544 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m00:41:04.644158 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:04.645156 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m00:41:04.646034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:04.663645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m00:41:04.664842 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:04.665929 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m00:41:04.669815 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.003 seconds
[0m00:41:04.674894 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:04.676114 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m00:41:04.679243 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:41:04.684207 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:04.685914 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m00:41:04.689647 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:41:04.693207 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m00:41:04.694580 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:04.695977 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m00:41:04.703598 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m00:41:04.708625 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m00:41:04.710504 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:04.711741 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m00:41:04.718462 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m00:41:04.721973 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m00:41:04.723896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cad83a4-58ef-4811-bcd5-f3700b399eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b3504ef0>]}
[0m00:41:04.727644 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.11s]
[0m00:41:04.729436 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m00:41:04.731677 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m00:41:04.733002 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m00:41:04.734596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m00:41:04.735998 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m00:41:04.741400 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m00:41:04.749872 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m00:41:04.755980 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m00:41:04.765513 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:41:04.766507 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m00:41:04.767529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:04.788917 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m00:41:04.790455 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:41:04.791841 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m00:41:04.798153 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.005 seconds
[0m00:41:04.803500 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:41:04.804777 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m00:41:04.808525 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:41:04.811647 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m00:41:04.812925 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:41:04.814411 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m00:41:04.823573 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m00:41:04.828443 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m00:41:04.830467 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:41:04.832009 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m00:41:04.835709 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m00:41:04.838695 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m00:41:04.840282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cad83a4-58ef-4811-bcd5-f3700b399eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b33edca0>]}
[0m00:41:04.842070 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.11s]
[0m00:41:04.844253 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m00:41:04.847482 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:04.848894 [debug] [MainThread]: On master: BEGIN
[0m00:41:04.849685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:41:04.869781 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m00:41:04.871299 [debug] [MainThread]: On master: COMMIT
[0m00:41:04.872442 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:04.873503 [debug] [MainThread]: On master: COMMIT
[0m00:41:04.875902 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:41:04.877101 [debug] [MainThread]: On master: Close
[0m00:41:04.878366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:41:04.879542 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m00:41:04.880689 [info ] [MainThread]: 
[0m00:41:04.881963 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m00:41:04.884516 [debug] [MainThread]: Command end result
[0m00:41:04.955757 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:41:04.963802 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:41:04.979395 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m00:41:04.980593 [info ] [MainThread]: 
[0m00:41:04.981882 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:41:04.983162 [info ] [MainThread]: 
[0m00:41:04.984489 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:41:04.986369 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2934275, "process_in_blocks": "0", "process_kernel_time": 0.268554, "process_mem_max_rss": "107472", "process_out_blocks": "0", "process_user_time": 3.078787}
[0m00:41:04.987981 [debug] [MainThread]: Command `dbt run` succeeded at 00:41:04.987812 after 2.30 seconds
[0m00:41:04.989174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b7e14500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b718cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b366fe90>]}
[0m00:41:04.990459 [debug] [MainThread]: Flushing usage events
[0m00:41:05.329660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:41:21.946074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f024bbc0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f024a1e6030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f024a1e7290>]}


============================== 00:41:21.955282 | 59521931-b23c-46df-9470-dd710965645d ==============================
[0m00:41:21.955282 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:41:21.957162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m00:41:22.242744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59521931-b23c-46df-9470-dd710965645d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0249c44320>]}
[0m00:41:22.332149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59521931-b23c-46df-9470-dd710965645d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0249b83d10>]}
[0m00:41:22.334280 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:41:22.453280 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m00:41:22.776643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:41:22.778169 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:41:22.851751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59521931-b23c-46df-9470-dd710965645d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0249baecc0>]}
[0m00:41:23.016111 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:41:23.024970 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:41:23.067869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59521931-b23c-46df-9470-dd710965645d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02480caf00>]}
[0m00:41:23.069630 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m00:41:23.071207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59521931-b23c-46df-9470-dd710965645d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02483bcb30>]}
[0m00:41:23.075933 [info ] [MainThread]: 
[0m00:41:23.077764 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:41:23.079168 [info ] [MainThread]: 
[0m00:41:23.080877 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:41:23.087485 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m00:41:23.141748 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m00:41:23.143454 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m00:41:23.145075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:41:23.175789 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.031 seconds
[0m00:41:23.178269 [debug] [ThreadPool]: On list_destination_db: Close
[0m00:41:23.181076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m00:41:23.192826 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:41:23.194199 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m00:41:23.195631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:41:23.218290 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m00:41:23.219433 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:41:23.220480 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:41:23.226862 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m00:41:23.229480 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m00:41:23.232263 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m00:41:23.240826 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:23.242275 [debug] [MainThread]: On master: BEGIN
[0m00:41:23.243604 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:41:23.264831 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m00:41:23.266213 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:23.267770 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:41:23.274968 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m00:41:23.277961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59521931-b23c-46df-9470-dd710965645d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f024727dee0>]}
[0m00:41:23.279315 [debug] [MainThread]: On master: ROLLBACK
[0m00:41:23.282146 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:23.283322 [debug] [MainThread]: On master: BEGIN
[0m00:41:23.287225 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:41:23.288136 [debug] [MainThread]: On master: COMMIT
[0m00:41:23.288933 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:23.289728 [debug] [MainThread]: On master: COMMIT
[0m00:41:23.291553 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:41:23.292524 [debug] [MainThread]: On master: Close
[0m00:41:23.295330 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m00:41:23.296808 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m00:41:23.298015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m00:41:23.298903 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m00:41:23.310485 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m00:41:23.321996 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m00:41:23.383823 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m00:41:23.395639 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:23.396759 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m00:41:23.397745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:23.420504 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m00:41:23.421607 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:23.422602 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m00:41:23.425115 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m00:41:23.426164 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m00:41:23.428322 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m00:41:23.434967 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m00:41:23.438063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59521931-b23c-46df-9470-dd710965645d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f024a736930>]}
[0m00:41:23.439846 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m00:41:23.441572 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m00:41:23.442981 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m00:41:23.446939 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.actors' to be skipped because of status 'error'.  Reason: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql.
[0m00:41:23.448635 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m00:41:23.452320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m00:41:23.453729 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m00:41:23.458278 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m00:41:23.470257 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m00:41:23.476009 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m00:41:23.485522 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:23.486591 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m00:41:23.487514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:23.508307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m00:41:23.509508 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:23.510598 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m00:41:23.513565 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m00:41:23.514952 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m00:41:23.517578 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m00:41:23.522668 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m00:41:23.524440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59521931-b23c-46df-9470-dd710965645d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0247f445f0>]}
[0m00:41:23.526572 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m00:41:23.528438 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m00:41:23.529876 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m00:41:23.530665 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_actors' to be skipped because of status 'error'.  Reason: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql.
[0m00:41:23.532080 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m00:41:23.534424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m00:41:23.535628 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m00:41:23.539926 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m00:41:23.550082 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m00:41:23.555746 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m00:41:23.564265 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:23.565303 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m00:41:23.566339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:23.587350 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m00:41:23.588693 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:23.589929 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m00:41:23.593243 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m00:41:23.594393 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m00:41:23.597008 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m00:41:23.601777 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m00:41:23.603214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59521931-b23c-46df-9470-dd710965645d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f024596fda0>]}
[0m00:41:23.604778 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m00:41:23.606503 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m00:41:23.607922 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.films' to be skipped because of status 'error'.  Reason: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql.
[0m00:41:23.610062 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m00:41:23.611484 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m00:41:23.613094 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m00:41:23.616203 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:23.618594 [debug] [MainThread]: On master: BEGIN
[0m00:41:23.620351 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:41:23.646891 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m00:41:23.648125 [debug] [MainThread]: On master: COMMIT
[0m00:41:23.649420 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:23.650600 [debug] [MainThread]: On master: COMMIT
[0m00:41:23.652709 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:41:23.653695 [debug] [MainThread]: On master: Close
[0m00:41:23.655057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:41:23.657177 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m00:41:23.658443 [info ] [MainThread]: 
[0m00:41:23.659836 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m00:41:23.662326 [debug] [MainThread]: Command end result
[0m00:41:23.734525 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:41:23.742781 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:41:23.759343 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m00:41:23.761127 [info ] [MainThread]: 
[0m00:41:23.762903 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m00:41:23.764195 [info ] [MainThread]: 
[0m00:41:23.766009 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m00:41:23.767520 [info ] [MainThread]: 
[0m00:41:23.768948 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m00:41:23.770290 [info ] [MainThread]: 
[0m00:41:23.771614 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m00:41:23.773080 [info ] [MainThread]: 
[0m00:41:23.774807 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m00:41:23.778090 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9247563, "process_in_blocks": "0", "process_kernel_time": 0.310053, "process_mem_max_rss": "108392", "process_out_blocks": "1600", "process_user_time": 3.110224}
[0m00:41:23.779619 [debug] [MainThread]: Command `dbt run` failed at 00:41:23.779481 after 1.93 seconds
[0m00:41:23.781054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0249e0d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f024a7e1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f024b5df620>]}
[0m00:41:23.782373 [debug] [MainThread]: Flushing usage events
[0m00:41:24.282238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:41:30.595545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661487cbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661487e8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66142f4cb0>]}


============================== 00:41:30.601256 | 94b9ebba-a88f-4626-96c0-3987866ca214 ==============================
[0m00:41:30.601256 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:41:30.603687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:41:30.889948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94b9ebba-a88f-4626-96c0-3987866ca214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661417c9e0>]}
[0m00:41:30.981703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94b9ebba-a88f-4626-96c0-3987866ca214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66143f1f70>]}
[0m00:41:30.983985 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:41:31.122560 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m00:41:31.460940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:41:31.462499 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:41:31.535865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94b9ebba-a88f-4626-96c0-3987866ca214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6612a06480>]}
[0m00:41:31.696449 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:41:31.705373 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:41:31.737340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94b9ebba-a88f-4626-96c0-3987866ca214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66125fb500>]}
[0m00:41:31.738909 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m00:41:31.740655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94b9ebba-a88f-4626-96c0-3987866ca214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6612899130>]}
[0m00:41:31.744632 [info ] [MainThread]: 
[0m00:41:31.746324 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:41:31.747877 [info ] [MainThread]: 
[0m00:41:31.749765 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:41:31.756592 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m00:41:31.810055 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m00:41:31.811850 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m00:41:31.813389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:41:31.839659 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.026 seconds
[0m00:41:31.842414 [debug] [ThreadPool]: On list_destination_db: Close
[0m00:41:31.845844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m00:41:31.856353 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:41:31.857711 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m00:41:31.858826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:41:31.879527 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m00:41:31.880479 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:41:31.881411 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:41:31.886704 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m00:41:31.889406 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m00:41:31.891810 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m00:41:31.902477 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:31.903870 [debug] [MainThread]: On master: BEGIN
[0m00:41:31.905122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:41:31.923707 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m00:41:31.924884 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:31.926175 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:41:31.932161 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m00:41:31.935113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94b9ebba-a88f-4626-96c0-3987866ca214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6612a07da0>]}
[0m00:41:31.936531 [debug] [MainThread]: On master: ROLLBACK
[0m00:41:31.939692 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:31.940922 [debug] [MainThread]: On master: BEGIN
[0m00:41:31.944616 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:41:31.945565 [debug] [MainThread]: On master: COMMIT
[0m00:41:31.946452 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:31.947563 [debug] [MainThread]: On master: COMMIT
[0m00:41:31.949636 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:41:31.950567 [debug] [MainThread]: On master: Close
[0m00:41:31.953708 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m00:41:31.955228 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m00:41:31.956347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m00:41:31.957307 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m00:41:31.969558 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m00:41:31.983223 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m00:41:32.043562 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m00:41:32.054096 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:32.055675 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m00:41:32.057431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:32.084439 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m00:41:32.085447 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:32.086354 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m00:41:32.089667 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.002 seconds
[0m00:41:32.099380 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:32.100704 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m00:41:32.105065 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:41:32.111347 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:32.112537 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m00:41:32.115978 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:41:32.146102 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m00:41:32.147650 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:32.148996 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m00:41:32.158123 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m00:41:32.169371 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m00:41:32.177387 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:32.178801 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m00:41:32.187244 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m00:41:32.191946 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m00:41:32.195479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b9ebba-a88f-4626-96c0-3987866ca214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6615ed2630>]}
[0m00:41:32.197638 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.24s]
[0m00:41:32.199642 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m00:41:32.201117 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m00:41:32.202675 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m00:41:32.204079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m00:41:32.205290 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m00:41:32.209628 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m00:41:32.218376 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m00:41:32.223803 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m00:41:32.231659 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:32.232764 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m00:41:32.233759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:32.256223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m00:41:32.257521 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:32.258709 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m00:41:32.262920 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.003 seconds
[0m00:41:32.267831 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:32.269019 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m00:41:32.272775 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:41:32.278169 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:32.279622 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m00:41:32.283303 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:41:32.286884 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m00:41:32.287928 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:32.289001 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m00:41:32.296691 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m00:41:32.302341 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m00:41:32.303883 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:32.305477 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m00:41:32.311978 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m00:41:32.315306 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m00:41:32.317032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b9ebba-a88f-4626-96c0-3987866ca214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66106a53a0>]}
[0m00:41:32.318786 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.11s]
[0m00:41:32.320609 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m00:41:32.322315 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m00:41:32.323664 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m00:41:32.325367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m00:41:32.326604 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m00:41:32.331173 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m00:41:32.340438 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m00:41:32.345731 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m00:41:32.354535 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:32.355718 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m00:41:32.356613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:32.377778 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m00:41:32.379025 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:32.379988 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m00:41:32.384029 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.003 seconds
[0m00:41:32.388890 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:32.390570 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m00:41:32.394084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:41:32.399213 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:32.400218 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m00:41:32.403493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:41:32.406480 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m00:41:32.407660 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:32.408751 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m00:41:32.413446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m00:41:32.417631 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m00:41:32.418907 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:32.419897 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m00:41:32.425316 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:41:32.427789 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m00:41:32.429059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b9ebba-a88f-4626-96c0-3987866ca214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66117c8fb0>]}
[0m00:41:32.430680 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.10s]
[0m00:41:32.432481 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m00:41:32.435034 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m00:41:32.436513 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m00:41:32.437942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m00:41:32.439024 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m00:41:32.444781 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m00:41:32.452174 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m00:41:32.457475 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m00:41:32.466164 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:41:32.467321 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m00:41:32.468255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:32.487412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m00:41:32.488423 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:41:32.489458 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m00:41:32.495260 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.005 seconds
[0m00:41:32.500882 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:41:32.502259 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m00:41:32.505716 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:41:32.508693 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m00:41:32.510114 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:41:32.511630 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m00:41:32.519511 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m00:41:32.523785 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m00:41:32.525591 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:41:32.527209 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m00:41:32.530659 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m00:41:32.533477 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m00:41:32.535552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b9ebba-a88f-4626-96c0-3987866ca214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661185a660>]}
[0m00:41:32.538052 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.10s]
[0m00:41:32.540398 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m00:41:32.544100 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:32.545378 [debug] [MainThread]: On master: BEGIN
[0m00:41:32.546397 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:41:32.566562 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m00:41:32.567648 [debug] [MainThread]: On master: COMMIT
[0m00:41:32.568676 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:32.569664 [debug] [MainThread]: On master: COMMIT
[0m00:41:32.572452 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:41:32.573497 [debug] [MainThread]: On master: Close
[0m00:41:32.574880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:41:32.576158 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m00:41:32.577315 [info ] [MainThread]: 
[0m00:41:32.579063 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m00:41:32.581777 [debug] [MainThread]: Command end result
[0m00:41:32.659300 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:41:32.667060 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:41:32.682490 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m00:41:32.683954 [info ] [MainThread]: 
[0m00:41:32.685395 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:41:32.686799 [info ] [MainThread]: 
[0m00:41:32.688165 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:41:32.690637 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2420979, "process_in_blocks": "0", "process_kernel_time": 0.189285, "process_mem_max_rss": "109064", "process_out_blocks": "0", "process_user_time": 3.312493}
[0m00:41:32.692199 [debug] [MainThread]: Command `dbt run` succeeded at 00:41:32.691987 after 2.24 seconds
[0m00:41:32.693576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6616158620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6614c0cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661191e4b0>]}
[0m00:41:32.695030 [debug] [MainThread]: Flushing usage events
[0m00:41:31.754551 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:41:35.074103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36159cf770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3615317a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36159ce930>]}


============================== 00:41:35.078955 | e3a3dc7c-01bf-4f2e-b1b6-196d7c1f1af6 ==============================
[0m00:41:35.078955 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:41:35.080722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m00:41:35.379415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3a3dc7c-01bf-4f2e-b1b6-196d7c1f1af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3614f3eb70>]}
[0m00:41:35.491162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3a3dc7c-01bf-4f2e-b1b6-196d7c1f1af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3614f1f920>]}
[0m00:41:35.493719 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:41:35.624925 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m00:41:35.979258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:41:35.980299 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:41:36.074499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3a3dc7c-01bf-4f2e-b1b6-196d7c1f1af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36136b8d40>]}
[0m00:41:36.252331 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:41:36.260459 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:41:36.294786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3a3dc7c-01bf-4f2e-b1b6-196d7c1f1af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36135d1250>]}
[0m00:41:36.296308 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m00:41:36.297889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3a3dc7c-01bf-4f2e-b1b6-196d7c1f1af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36135f5b50>]}
[0m00:41:36.302911 [info ] [MainThread]: 
[0m00:41:36.304460 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:41:36.306432 [info ] [MainThread]: 
[0m00:41:36.308609 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:41:36.316507 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m00:41:36.385934 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m00:41:36.387500 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m00:41:36.388706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:41:36.413518 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.025 seconds
[0m00:41:36.416181 [debug] [ThreadPool]: On list_destination_db: Close
[0m00:41:36.419329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m00:41:36.429956 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:41:36.431180 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m00:41:36.432420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:41:36.454806 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m00:41:36.456969 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:41:36.458330 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:41:36.465369 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m00:41:36.468855 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m00:41:36.471796 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m00:41:36.482302 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:36.484015 [debug] [MainThread]: On master: BEGIN
[0m00:41:36.485533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:41:36.509250 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m00:41:36.510442 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:36.512090 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:41:36.519339 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m00:41:36.522981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3a3dc7c-01bf-4f2e-b1b6-196d7c1f1af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3616d0c9b0>]}
[0m00:41:36.524910 [debug] [MainThread]: On master: ROLLBACK
[0m00:41:36.529117 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:36.530632 [debug] [MainThread]: On master: BEGIN
[0m00:41:36.534868 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:41:36.535841 [debug] [MainThread]: On master: COMMIT
[0m00:41:36.537110 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:36.538100 [debug] [MainThread]: On master: COMMIT
[0m00:41:36.540222 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:41:36.541223 [debug] [MainThread]: On master: Close
[0m00:41:36.544330 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m00:41:36.545898 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m00:41:36.547679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m00:41:36.548996 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m00:41:36.563997 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m00:41:36.572061 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m00:41:36.638656 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m00:41:36.648226 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:36.649379 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m00:41:36.650435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:36.670392 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m00:41:36.671957 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:36.673233 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m00:41:36.678068 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.004 seconds
[0m00:41:36.689140 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:36.691002 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m00:41:36.694256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:41:36.700156 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:36.701732 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m00:41:36.705033 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:41:36.740841 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m00:41:36.742216 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:36.743428 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m00:41:36.748139 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m00:41:36.758426 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m00:41:36.766719 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:41:36.768061 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m00:41:36.774287 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m00:41:36.779019 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m00:41:36.783313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3a3dc7c-01bf-4f2e-b1b6-196d7c1f1af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3616c5aab0>]}
[0m00:41:36.785545 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 40[0m in 0.23s]
[0m00:41:36.787747 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m00:41:36.789363 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m00:41:36.791043 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m00:41:36.792725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m00:41:36.794139 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m00:41:36.799496 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m00:41:36.808324 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m00:41:36.814162 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m00:41:36.822248 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:36.823353 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m00:41:36.824379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:36.842197 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m00:41:36.843753 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:36.845209 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m00:41:36.849033 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.003 seconds
[0m00:41:36.855176 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:36.856548 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m00:41:36.859129 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:41:36.864214 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:36.865481 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m00:41:36.871873 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m00:41:36.878352 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m00:41:36.879923 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:36.881439 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m00:41:36.888556 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m00:41:36.893296 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m00:41:36.894872 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:41:36.896050 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m00:41:36.900926 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:41:36.903894 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m00:41:36.905236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3a3dc7c-01bf-4f2e-b1b6-196d7c1f1af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3610c93e60>]}
[0m00:41:36.906767 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 40[0m in 0.11s]
[0m00:41:36.908692 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m00:41:36.909912 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m00:41:36.911222 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m00:41:36.912540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m00:41:36.913619 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m00:41:36.917972 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m00:41:36.925606 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m00:41:36.932517 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m00:41:36.939974 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:36.941134 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m00:41:36.942028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:36.959373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m00:41:36.960508 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:36.961715 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m00:41:36.966589 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.004 seconds
[0m00:41:36.972564 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:36.973771 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m00:41:36.976487 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:41:36.981431 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:36.982629 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m00:41:36.985919 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:41:36.988822 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m00:41:36.989880 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:36.990857 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m00:41:36.997375 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m00:41:37.001608 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m00:41:37.003030 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:41:37.004072 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m00:41:37.008727 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:41:37.011298 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m00:41:37.012820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3a3dc7c-01bf-4f2e-b1b6-196d7c1f1af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3610c7d2e0>]}
[0m00:41:37.015112 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 40[0m in 0.10s]
[0m00:41:37.017585 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m00:41:37.019685 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m00:41:37.021225 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m00:41:37.022725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m00:41:37.024164 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m00:41:37.031119 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m00:41:37.038462 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m00:41:37.044655 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m00:41:37.054566 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:41:37.055867 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m00:41:37.056925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:37.076496 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m00:41:37.078437 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:41:37.080290 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m00:41:37.087460 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.005 seconds
[0m00:41:37.093240 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:41:37.094540 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m00:41:37.097634 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:41:37.102693 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:41:37.103928 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m00:41:37.107570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:41:37.111149 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m00:41:37.112588 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:41:37.113932 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m00:41:37.118085 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m00:41:37.122694 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m00:41:37.124283 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:41:37.125407 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m00:41:37.130462 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:41:37.133078 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m00:41:37.135007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3a3dc7c-01bf-4f2e-b1b6-196d7c1f1af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3610c94e60>]}
[0m00:41:37.136593 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 40[0m in 0.11s]
[0m00:41:37.138556 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m00:41:37.141153 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:37.142386 [debug] [MainThread]: On master: BEGIN
[0m00:41:37.143613 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:41:37.163043 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m00:41:37.164448 [debug] [MainThread]: On master: COMMIT
[0m00:41:37.165607 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:37.166562 [debug] [MainThread]: On master: COMMIT
[0m00:41:37.169257 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:41:37.170197 [debug] [MainThread]: On master: Close
[0m00:41:37.185082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:41:37.186544 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m00:41:37.188339 [info ] [MainThread]: 
[0m00:41:37.190101 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m00:41:37.192800 [debug] [MainThread]: Command end result
[0m00:41:37.255125 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:41:37.260214 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:41:37.275093 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m00:41:37.276128 [info ] [MainThread]: 
[0m00:41:37.277734 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:41:37.279310 [info ] [MainThread]: 
[0m00:41:37.280893 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:41:37.283297 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3529196, "process_in_blocks": "0", "process_kernel_time": 0.347322, "process_mem_max_rss": "107404", "process_out_blocks": "0", "process_user_time": 3.318858}
[0m00:41:37.285457 [debug] [MainThread]: Command `dbt run` succeeded at 00:41:37.285074 after 2.36 seconds
[0m00:41:37.287279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3615416ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f361584c3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3610c4e8d0>]}
[0m00:41:37.288942 [debug] [MainThread]: Flushing usage events
[0m00:41:37.591696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:48:45.304975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771e265a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771e0e4560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771e265970>]}


============================== 00:48:45.313718 | f9cc4030-75ae-43d1-8cc3-0773eadc5d9b ==============================
[0m00:48:45.313718 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:48:45.316415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:48:45.616177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9cc4030-75ae-43d1-8cc3-0773eadc5d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771e064470>]}
[0m00:48:45.715416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9cc4030-75ae-43d1-8cc3-0773eadc5d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771dc7c3e0>]}
[0m00:48:45.718449 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:48:45.855112 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m00:48:46.222682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:48:46.224650 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/film_ratings_macro.sql
[0m00:48:46.226268 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m00:48:46.922296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9cc4030-75ae-43d1-8cc3-0773eadc5d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771ae86d50>]}
[0m00:48:47.085423 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:48:47.093733 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:48:47.136950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9cc4030-75ae-43d1-8cc3-0773eadc5d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771ae01130>]}
[0m00:48:47.138571 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 430 macros
[0m00:48:47.140294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9cc4030-75ae-43d1-8cc3-0773eadc5d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771c3fce60>]}
[0m00:48:47.146421 [info ] [MainThread]: 
[0m00:48:47.148451 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:48:47.150560 [info ] [MainThread]: 
[0m00:48:47.153013 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:48:47.161631 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m00:48:47.219535 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m00:48:47.221074 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m00:48:47.222529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:48:47.251328 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.029 seconds
[0m00:48:47.253871 [debug] [ThreadPool]: On list_destination_db: Close
[0m00:48:47.257495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m00:48:47.271283 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:48:47.272852 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m00:48:47.274258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:48:47.301336 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m00:48:47.302662 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:48:47.303801 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:48:47.310004 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m00:48:47.312878 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m00:48:47.315268 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m00:48:47.324066 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:47.325471 [debug] [MainThread]: On master: BEGIN
[0m00:48:47.327001 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:48:47.348664 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m00:48:47.349912 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:47.351313 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:48:47.357476 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m00:48:47.360709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9cc4030-75ae-43d1-8cc3-0773eadc5d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771ada4050>]}
[0m00:48:47.362267 [debug] [MainThread]: On master: ROLLBACK
[0m00:48:47.364539 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:47.365669 [debug] [MainThread]: On master: BEGIN
[0m00:48:47.369132 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:48:47.370232 [debug] [MainThread]: On master: COMMIT
[0m00:48:47.371246 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:47.372204 [debug] [MainThread]: On master: COMMIT
[0m00:48:47.374525 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:48:47.375536 [debug] [MainThread]: On master: Close
[0m00:48:47.378839 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m00:48:47.380655 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m00:48:47.382830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m00:48:47.384581 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m00:48:47.397690 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m00:48:47.405943 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m00:48:47.467639 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m00:48:47.477794 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:48:47.479009 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m00:48:47.480037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:48:47.499324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m00:48:47.500725 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:48:47.501870 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m00:48:47.504699 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m00:48:47.505836 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m00:48:47.508264 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m00:48:47.514980 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m00:48:47.518638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9cc4030-75ae-43d1-8cc3-0773eadc5d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771c1b2d20>]}
[0m00:48:47.520079 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.13s]
[0m00:48:47.521772 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m00:48:47.522885 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m00:48:47.523722 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.actors' to be skipped because of status 'error'.  Reason: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql.
[0m00:48:47.524832 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m00:48:47.527585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m00:48:47.528656 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m00:48:47.533509 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m00:48:47.541007 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m00:48:47.547231 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m00:48:47.554225 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:48:47.555488 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m00:48:47.556359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:48:47.577548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m00:48:47.578593 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:48:47.579587 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m00:48:47.582441 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m00:48:47.583487 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m00:48:47.585765 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m00:48:47.591141 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m00:48:47.592658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9cc4030-75ae-43d1-8cc3-0773eadc5d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771ac84e60>]}
[0m00:48:47.594372 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m00:48:47.596237 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m00:48:47.597423 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m00:48:47.598352 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_actors' to be skipped because of status 'error'.  Reason: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql.
[0m00:48:47.599828 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m00:48:47.602493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m00:48:47.603561 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m00:48:47.608018 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m00:48:47.615497 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m00:48:47.621547 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m00:48:47.629320 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:48:47.630837 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m00:48:47.632094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:48:47.651651 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m00:48:47.652768 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:48:47.653803 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m00:48:47.656450 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m00:48:47.657704 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m00:48:47.660326 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m00:48:47.665607 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m00:48:47.666919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9cc4030-75ae-43d1-8cc3-0773eadc5d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77186fb7a0>]}
[0m00:48:47.668390 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.06s]
[0m00:48:47.670203 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m00:48:47.671650 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.films' to be skipped because of status 'error'.  Reason: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql.
[0m00:48:47.673639 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m00:48:47.674924 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m00:48:47.676576 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m00:48:47.679552 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:47.680857 [debug] [MainThread]: On master: BEGIN
[0m00:48:47.681869 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:48:47.702616 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m00:48:47.703939 [debug] [MainThread]: On master: COMMIT
[0m00:48:47.704846 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:47.705736 [debug] [MainThread]: On master: COMMIT
[0m00:48:47.707992 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:48:47.708995 [debug] [MainThread]: On master: Close
[0m00:48:47.710466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:48:47.711669 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m00:48:47.712771 [info ] [MainThread]: 
[0m00:48:47.714424 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m00:48:47.717007 [debug] [MainThread]: Command end result
[0m00:48:47.772276 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:48:47.779086 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:48:47.795636 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m00:48:47.796895 [info ] [MainThread]: 
[0m00:48:47.798590 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m00:48:47.800070 [info ] [MainThread]: 
[0m00:48:47.801546 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m00:48:47.802913 [info ] [MainThread]: 
[0m00:48:47.804612 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m00:48:47.806215 [info ] [MainThread]: 
[0m00:48:47.808137 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m00:48:47.809837 [info ] [MainThread]: 
[0m00:48:47.811598 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m00:48:47.814132 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6072664, "process_in_blocks": "480", "process_kernel_time": 0.304703, "process_mem_max_rss": "114620", "process_out_blocks": "1600", "process_user_time": 3.8564}
[0m00:48:47.815679 [debug] [MainThread]: Command `dbt run` failed at 00:48:47.815508 after 2.61 seconds
[0m00:48:47.816720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771de8ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771f01f320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771c458e60>]}
[0m00:48:47.817822 [debug] [MainThread]: Flushing usage events
[0m00:48:48.140142 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:49:09.672086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e8bf3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ea8e4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ea7a9d90>]}


============================== 00:49:09.680482 | 5d796aa3-21a3-4ad5-943f-5f849ee08492 ==============================
[0m00:49:09.680482 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:49:09.682150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/root', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:49:10.024545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d796aa3-21a3-4ad5-943f-5f849ee08492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e8ba5d00>]}
[0m00:49:10.193608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d796aa3-21a3-4ad5-943f-5f849ee08492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e88b78c0>]}
[0m00:49:10.195914 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:49:10.343432 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m00:49:10.704542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:49:10.706007 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:49:10.781501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d796aa3-21a3-4ad5-943f-5f849ee08492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e6f1c050>]}
[0m00:49:10.949588 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:49:10.957756 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:49:10.998517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d796aa3-21a3-4ad5-943f-5f849ee08492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e6f1d040>]}
[0m00:49:10.999878 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 430 macros
[0m00:49:11.001214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d796aa3-21a3-4ad5-943f-5f849ee08492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e89eb470>]}
[0m00:49:11.004959 [info ] [MainThread]: 
[0m00:49:11.006626 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:49:11.008099 [info ] [MainThread]: 
[0m00:49:11.009910 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:49:11.016822 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m00:49:11.074125 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m00:49:11.075797 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m00:49:11.077493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:49:11.108452 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.031 seconds
[0m00:49:11.111105 [debug] [ThreadPool]: On list_destination_db: Close
[0m00:49:11.114346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m00:49:11.124693 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:49:11.126062 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m00:49:11.127257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:49:11.149697 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m00:49:11.150785 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:49:11.151921 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:49:11.157958 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m00:49:11.160769 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m00:49:11.164302 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m00:49:11.174393 [debug] [MainThread]: Using postgres connection "master"
[0m00:49:11.175586 [debug] [MainThread]: On master: BEGIN
[0m00:49:11.176709 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:49:11.195965 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m00:49:11.197198 [debug] [MainThread]: Using postgres connection "master"
[0m00:49:11.198478 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:49:11.205392 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m00:49:11.208728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d796aa3-21a3-4ad5-943f-5f849ee08492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e6c40350>]}
[0m00:49:11.210218 [debug] [MainThread]: On master: ROLLBACK
[0m00:49:11.213224 [debug] [MainThread]: Using postgres connection "master"
[0m00:49:11.214528 [debug] [MainThread]: On master: BEGIN
[0m00:49:11.218281 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:49:11.219428 [debug] [MainThread]: On master: COMMIT
[0m00:49:11.220367 [debug] [MainThread]: Using postgres connection "master"
[0m00:49:11.221249 [debug] [MainThread]: On master: COMMIT
[0m00:49:11.223134 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:49:11.224017 [debug] [MainThread]: On master: Close
[0m00:49:11.226766 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m00:49:11.228220 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m00:49:11.229352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m00:49:11.230374 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m00:49:11.245302 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m00:49:11.255986 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m00:49:11.316139 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m00:49:11.329884 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:49:11.331115 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m00:49:11.332324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:49:11.353963 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m00:49:11.355342 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:49:11.356588 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m00:49:11.359764 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m00:49:11.360937 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m00:49:11.363813 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m00:49:11.369839 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m00:49:11.372591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d796aa3-21a3-4ad5-943f-5f849ee08492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e943a540>]}
[0m00:49:11.374086 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m00:49:11.375702 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m00:49:11.377015 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m00:49:11.377831 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.actors' to be skipped because of status 'error'.  Reason: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql.
[0m00:49:11.379153 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m00:49:11.382394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m00:49:11.383849 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m00:49:11.388222 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m00:49:11.397597 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m00:49:11.402598 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m00:49:11.410687 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:49:11.412127 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m00:49:11.413243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:49:11.433412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m00:49:11.434565 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:49:11.435646 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m00:49:11.438387 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m00:49:11.439555 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m00:49:11.441854 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m00:49:11.446412 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m00:49:11.447971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d796aa3-21a3-4ad5-943f-5f849ee08492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e5e7b380>]}
[0m00:49:11.449491 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m00:49:11.451425 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m00:49:11.452721 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m00:49:11.453473 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_actors' to be skipped because of status 'error'.  Reason: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql.
[0m00:49:11.454682 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m00:49:11.456289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m00:49:11.457236 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m00:49:11.461250 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m00:49:11.470312 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m00:49:11.475298 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m00:49:11.485824 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:49:11.486798 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m00:49:11.487680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:49:11.506896 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m00:49:11.507970 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:49:11.508893 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m00:49:11.511464 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m00:49:11.512585 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m00:49:11.515076 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m00:49:11.519811 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m00:49:11.521282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d796aa3-21a3-4ad5-943f-5f849ee08492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e5ed4c50>]}
[0m00:49:11.522784 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.06s]
[0m00:49:11.524363 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m00:49:11.525723 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.films' to be skipped because of status 'error'.  Reason: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql.
[0m00:49:11.527671 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m00:49:11.529085 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m00:49:11.530457 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m00:49:11.533110 [debug] [MainThread]: Using postgres connection "master"
[0m00:49:11.534333 [debug] [MainThread]: On master: BEGIN
[0m00:49:11.535370 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:49:11.555729 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m00:49:11.556735 [debug] [MainThread]: On master: COMMIT
[0m00:49:11.557539 [debug] [MainThread]: Using postgres connection "master"
[0m00:49:11.558424 [debug] [MainThread]: On master: COMMIT
[0m00:49:11.560429 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:49:11.561559 [debug] [MainThread]: On master: Close
[0m00:49:11.562670 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:49:11.563730 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m00:49:11.564774 [info ] [MainThread]: 
[0m00:49:11.565977 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m00:49:11.568084 [debug] [MainThread]: Command end result
[0m00:49:11.634509 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:49:11.642019 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:49:11.658288 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m00:49:11.659671 [info ] [MainThread]: 
[0m00:49:11.661289 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m00:49:11.662867 [info ] [MainThread]: 
[0m00:49:11.664326 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m00:49:11.665748 [info ] [MainThread]: 
[0m00:49:11.667265 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m00:49:11.668720 [info ] [MainThread]: 
[0m00:49:11.670388 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m00:49:11.671854 [info ] [MainThread]: 
[0m00:49:11.673178 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m00:49:11.675240 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.090509, "process_in_blocks": "0", "process_kernel_time": 0.320838, "process_mem_max_rss": "108516", "process_out_blocks": "1600", "process_user_time": 3.208382}
[0m00:49:11.676676 [debug] [MainThread]: Command `dbt run` failed at 00:49:11.676512 after 2.09 seconds
[0m00:49:11.677913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e8f52c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ec0baa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e5ed6180>]}
[0m00:49:11.679090 [debug] [MainThread]: Flushing usage events
[0m00:49:10.575439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:49:15.453893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef35421640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3573e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef33b94cb0>]}


============================== 00:49:15.458954 | 6bc26774-34b7-476d-85b4-55471ddb1fc1 ==============================
[0m00:49:15.458954 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:49:15.460847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:49:15.732449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bc26774-34b7-476d-85b4-55471ddb1fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef337a7440>]}
[0m00:49:15.834043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bc26774-34b7-476d-85b4-55471ddb1fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef355f2120>]}
[0m00:49:15.835854 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:49:15.963756 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m00:49:16.307761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:49:16.309766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:49:16.510724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bc26774-34b7-476d-85b4-55471ddb1fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef31f5ce00>]}
[0m00:49:16.704611 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:49:16.712696 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:49:16.744892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bc26774-34b7-476d-85b4-55471ddb1fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef31d87920>]}
[0m00:49:16.746221 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 430 macros
[0m00:49:16.747700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bc26774-34b7-476d-85b4-55471ddb1fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef34b1f8f0>]}
[0m00:49:16.751614 [info ] [MainThread]: 
[0m00:49:16.753016 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:49:16.754251 [info ] [MainThread]: 
[0m00:49:16.756125 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:49:16.763662 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m00:49:16.827474 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m00:49:16.828535 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m00:49:16.829651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:49:16.851086 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m00:49:16.853334 [debug] [ThreadPool]: On list_destination_db: Close
[0m00:49:16.856565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m00:49:16.866683 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:49:16.867776 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m00:49:16.868648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:49:16.885910 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m00:49:16.887033 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m00:49:16.888209 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:49:16.894089 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m00:49:16.896836 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m00:49:16.899320 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m00:49:16.909440 [debug] [MainThread]: Using postgres connection "master"
[0m00:49:16.910476 [debug] [MainThread]: On master: BEGIN
[0m00:49:16.911359 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:49:16.929028 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m00:49:16.930040 [debug] [MainThread]: Using postgres connection "master"
[0m00:49:16.931212 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:49:16.937340 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m00:49:16.940003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bc26774-34b7-476d-85b4-55471ddb1fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef30f3dc40>]}
[0m00:49:16.941178 [debug] [MainThread]: On master: ROLLBACK
[0m00:49:16.943487 [debug] [MainThread]: Using postgres connection "master"
[0m00:49:16.944525 [debug] [MainThread]: On master: BEGIN
[0m00:49:16.950436 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m00:49:16.960673 [debug] [MainThread]: On master: COMMIT
[0m00:49:16.962054 [debug] [MainThread]: Using postgres connection "master"
[0m00:49:16.962995 [debug] [MainThread]: On master: COMMIT
[0m00:49:16.965437 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:49:16.966453 [debug] [MainThread]: On master: Close
[0m00:49:16.970389 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m00:49:16.972131 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m00:49:16.973694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m00:49:16.974766 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m00:49:16.988415 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m00:49:16.995550 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m00:49:17.058545 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m00:49:17.067383 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:49:17.068665 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m00:49:17.070174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:49:17.089659 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m00:49:17.090786 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:49:17.091805 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m00:49:17.095363 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.003 seconds
[0m00:49:17.107046 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:49:17.108563 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m00:49:17.111425 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:49:17.118221 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:49:17.120048 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m00:49:17.123084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:49:17.156420 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m00:49:17.157579 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:49:17.158941 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m00:49:17.162929 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m00:49:17.172771 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m00:49:17.182080 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m00:49:17.183216 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m00:49:17.188618 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:49:17.192627 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m00:49:17.196432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bc26774-34b7-476d-85b4-55471ddb1fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef30f1c4a0>]}
[0m00:49:17.198385 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.22s]
[0m00:49:17.200193 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m00:49:17.201337 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m00:49:17.202684 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m00:49:17.204801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m00:49:17.206464 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m00:49:17.211395 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m00:49:17.218316 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m00:49:17.223632 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m00:49:17.231148 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:49:17.232221 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m00:49:17.233143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:49:17.252290 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m00:49:17.253523 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:49:17.254766 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m00:49:17.258935 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.003 seconds
[0m00:49:17.264091 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:49:17.265209 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m00:49:17.267827 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:49:17.272714 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:49:17.273812 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m00:49:17.276699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:49:17.279446 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m00:49:17.280498 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:49:17.281464 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m00:49:17.285397 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m00:49:17.291172 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m00:49:17.292683 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m00:49:17.293901 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m00:49:17.299032 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:49:17.301561 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m00:49:17.302971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bc26774-34b7-476d-85b4-55471ddb1fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef30e31b50>]}
[0m00:49:17.304693 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.10s]
[0m00:49:17.306947 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m00:49:17.308942 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m00:49:17.310871 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m00:49:17.312355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m00:49:17.313357 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m00:49:17.317727 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m00:49:17.324807 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m00:49:17.330198 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m00:49:17.336965 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:49:17.338160 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m00:49:17.339342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:49:17.361932 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m00:49:17.363321 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:49:17.364461 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m00:49:17.368545 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.003 seconds
[0m00:49:17.373675 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:49:17.374837 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m00:49:17.377553 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:49:17.382349 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:49:17.383621 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m00:49:17.386325 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:49:17.389291 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m00:49:17.390396 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:49:17.391488 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m00:49:17.398494 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m00:49:17.402775 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m00:49:17.404153 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m00:49:17.405143 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m00:49:17.411126 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m00:49:17.414161 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m00:49:17.415647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bc26774-34b7-476d-85b4-55471ddb1fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef30dfc650>]}
[0m00:49:17.417347 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.10s]
[0m00:49:17.419306 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m00:49:17.421192 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m00:49:17.422389 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m00:49:17.423762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m00:49:17.424838 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m00:49:17.432106 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m00:49:17.440364 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m00:49:17.446384 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m00:49:17.454107 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:49:17.455229 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m00:49:17.456285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:49:17.475863 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m00:49:17.477056 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:49:17.478287 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    

WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m00:49:17.484468 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.005 seconds
[0m00:49:17.490425 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:49:17.491589 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m00:49:17.494021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:49:17.496517 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m00:49:17.497532 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:49:17.498490 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m00:49:17.505471 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m00:49:17.511756 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m00:49:17.513868 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m00:49:17.515520 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m00:49:17.518979 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m00:49:17.521632 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m00:49:17.523137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bc26774-34b7-476d-85b4-55471ddb1fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef30ec1c70>]}
[0m00:49:17.524838 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.10s]
[0m00:49:17.526877 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m00:49:17.529312 [debug] [MainThread]: Using postgres connection "master"
[0m00:49:17.530324 [debug] [MainThread]: On master: BEGIN
[0m00:49:17.531317 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:49:17.550417 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m00:49:17.551514 [debug] [MainThread]: On master: COMMIT
[0m00:49:17.552467 [debug] [MainThread]: Using postgres connection "master"
[0m00:49:17.553354 [debug] [MainThread]: On master: COMMIT
[0m00:49:17.555637 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:49:17.556772 [debug] [MainThread]: On master: Close
[0m00:49:17.558005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:49:17.559380 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m00:49:17.560752 [info ] [MainThread]: 
[0m00:49:17.562576 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m00:49:17.567096 [debug] [MainThread]: Command end result
[0m00:49:17.623464 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:49:17.629431 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:49:17.645958 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m00:49:17.647279 [info ] [MainThread]: 
[0m00:49:17.648941 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:49:17.650493 [info ] [MainThread]: 
[0m00:49:17.652505 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:49:17.655108 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3289921, "process_in_blocks": "0", "process_kernel_time": 0.312793, "process_mem_max_rss": "108900", "process_out_blocks": "0", "process_user_time": 3.336465}
[0m00:49:17.656779 [debug] [MainThread]: Command `dbt run` succeeded at 00:49:17.656569 after 2.33 seconds
[0m00:49:17.658132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef343e49e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3101c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef345a2cc0>]}
[0m00:49:17.659548 [debug] [MainThread]: Flushing usage events
[0m00:49:17.903429 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:55:34.851766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd599770200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd598e6dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5997721b0>]}


============================== 00:55:34.860458 | 97235410-af9c-4129-8df8-eba548d684b5 ==============================
[0m00:55:34.860458 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:55:34.862312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:55:35.171232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97235410-af9c-4129-8df8-eba548d684b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd599770200>]}
[0m00:55:35.289046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97235410-af9c-4129-8df8-eba548d684b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd599770e90>]}
[0m00:55:35.293033 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:55:35.463090 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m00:55:35.945223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:55:35.946403 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/ratings_macro.sql
[0m00:55:35.947577 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://macros/film_ratings_macro.sql
[0m00:55:36.245482 [error] [MainThread]: Encountered an error:
Compilation Error in model film_ratings (models/example/film_ratings.sql)
  'generate_ratings' is undefined
[0m00:55:36.247844 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4883255, "process_in_blocks": "16", "process_kernel_time": 0.248793, "process_mem_max_rss": "99644", "process_out_blocks": "1488", "process_user_time": 2.918537}
[0m00:55:36.249630 [debug] [MainThread]: Command `dbt run` failed at 00:55:36.249392 after 1.49 seconds
[0m00:55:36.251017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59a681af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd596ddede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd597253f50>]}
[0m00:55:36.252475 [debug] [MainThread]: Flushing usage events
[0m00:55:36.558292 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:55:41.466631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b9504e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b9504d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b9d20cb0>]}


============================== 00:55:41.471686 | 519c3206-4353-4e98-a6cd-db8120040afd ==============================
[0m00:55:41.471686 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:55:41.473382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:55:41.753161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '519c3206-4353-4e98-a6cd-db8120040afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b7be3380>]}
[0m00:55:41.855640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '519c3206-4353-4e98-a6cd-db8120040afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b7c7c1d0>]}
[0m00:55:41.857756 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:55:41.982256 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m00:55:42.331154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:55:42.332464 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/ratings_macro.sql
[0m00:55:42.333732 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://macros/film_ratings_macro.sql
[0m00:55:42.680229 [error] [MainThread]: Encountered an error:
Compilation Error in model film_ratings (models/example/film_ratings.sql)
  'generate_ratings' is undefined
[0m00:55:42.682242 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3424314, "process_in_blocks": "0", "process_kernel_time": 0.155944, "process_mem_max_rss": "98840", "process_out_blocks": "0", "process_user_time": 2.923951}
[0m00:55:42.683695 [debug] [MainThread]: Command `dbt run` failed at 00:55:42.683471 after 1.34 seconds
[0m00:55:42.684900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b94d4f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b9432c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b78388f0>]}
[0m00:55:42.685897 [debug] [MainThread]: Flushing usage events
[0m00:55:43.034936 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:00:57.535604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e877770e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e873af3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e891f6480>]}


============================== 01:00:57.543849 | f3b7ab27-9e64-45d2-9558-61f37015aee8 ==============================
[0m01:00:57.543849 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:00:57.545662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:00:57.821583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3b7ab27-9e64-45d2-9558-61f37015aee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e8712b710>]}
[0m01:00:57.910161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3b7ab27-9e64-45d2-9558-61f37015aee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e87846cc0>]}
[0m01:00:57.912309 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:00:58.030077 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m01:00:58.356176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m01:00:58.358249 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/ratings_macro.sql
[0m01:00:58.360492 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://macros/film_ratings_macro.sql
[0m01:00:58.639281 [error] [MainThread]: Encountered an error:
Compilation Error in model film_ratings (models/example/film_ratings.sql)
  'generate_ratings' is undefined
[0m01:00:58.641792 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2000737, "process_in_blocks": "0", "process_kernel_time": 0.212118, "process_mem_max_rss": "99612", "process_out_blocks": "1488", "process_user_time": 2.931095}
[0m01:00:58.643837 [debug] [MainThread]: Command `dbt run` failed at 01:00:58.643682 after 1.20 seconds
[0m01:00:58.645665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e873e4ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e87d00fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e8589f0b0>]}
[0m01:00:58.647167 [debug] [MainThread]: Flushing usage events
[0m01:00:59.003795 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:01:02.181835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e58a8b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e58a8af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e58b4b080>]}


============================== 01:01:02.186855 | 4bde56ca-40a8-46dd-8e1d-cc4f4f9f40fa ==============================
[0m01:01:02.186855 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:01:02.189013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:01:02.465733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bde56ca-40a8-46dd-8e1d-cc4f4f9f40fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e57e47d10>]}
[0m01:01:02.570893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bde56ca-40a8-46dd-8e1d-cc4f4f9f40fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e57efaea0>]}
[0m01:01:02.573034 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:01:02.684915 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m01:01:03.008250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m01:01:03.010210 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/ratings_macro.sql
[0m01:01:03.012141 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://macros/film_ratings_macro.sql
[0m01:01:03.295681 [error] [MainThread]: Encountered an error:
Compilation Error in model film_ratings (models/example/film_ratings.sql)
  'generate_ratings' is undefined
[0m01:01:03.298019 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2542162, "process_in_blocks": "0", "process_kernel_time": 0.200905, "process_mem_max_rss": "99144", "process_out_blocks": "0", "process_user_time": 2.669176}
[0m01:01:03.300159 [debug] [MainThread]: Command `dbt run` failed at 01:01:03.299811 after 1.26 seconds
[0m01:01:03.301810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e58a8b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e563905f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e564cb5f0>]}
[0m01:01:03.303204 [debug] [MainThread]: Flushing usage events
[0m01:01:03.457675 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:01:07.924253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40d5ba9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40d5baa570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40d5a34cb0>]}


============================== 01:01:07.928990 | 07456b67-894d-4336-bae8-5be4d5826b16 ==============================
[0m01:01:07.928990 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:01:07.930445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:01:08.213526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07456b67-894d-4336-bae8-5be4d5826b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40d5713b00>]}
[0m01:01:07.745950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07456b67-894d-4336-bae8-5be4d5826b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40d55a7c80>]}
[0m01:01:07.748657 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:01:07.116602 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m01:01:07.466635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m01:01:07.468546 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/ratings_macro.sql
[0m01:01:07.469996 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://macros/film_ratings_macro.sql
[0m01:01:07.801081 [error] [MainThread]: Encountered an error:
Compilation Error in model film_ratings (models/example/film_ratings.sql)
  'generate_ratings' is undefined
[0m01:01:07.803828 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3832548, "process_in_blocks": "0", "process_kernel_time": 0.236543, "process_mem_max_rss": "99380", "process_out_blocks": "0", "process_user_time": 2.970989}
[0m01:01:07.805732 [debug] [MainThread]: Command `dbt run` failed at 01:01:07.805504 after 1.39 seconds
[0m01:01:07.807181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40d59412b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40d3aec9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40d3c27b90>]}
[0m01:01:07.808672 [debug] [MainThread]: Flushing usage events
[0m01:01:08.137248 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:11:23.090703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2f1ba180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2db53ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d7d0ce0>]}


============================== 01:11:23.104051 | be9d8019-120b-4aad-a5ef-00565c0b3fbc ==============================
[0m01:11:23.104051 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:11:23.105710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:11:23.513473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be9d8019-120b-4aad-a5ef-00565c0b3fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d4c1e20>]}
[0m01:11:23.661546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be9d8019-120b-4aad-a5ef-00565c0b3fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d4c2ba0>]}
[0m01:11:23.663959 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:11:23.814650 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m01:11:24.261020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m01:11:24.262539 [debug] [MainThread]: Partial parsing: added file: custom_postgres://models/example/specific_movie.sql
[0m01:11:24.263985 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/ratings_macro.sql
[0m01:11:24.718344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be9d8019-120b-4aad-a5ef-00565c0b3fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2bcb0920>]}
[0m01:11:24.874678 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m01:11:24.882635 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m01:11:24.935706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be9d8019-120b-4aad-a5ef-00565c0b3fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2bab0590>]}
[0m01:11:24.937312 [info ] [MainThread]: Found 5 models, 20 data tests, 3 sources, 430 macros
[0m01:11:24.938723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be9d8019-120b-4aad-a5ef-00565c0b3fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2b76a240>]}
[0m01:11:24.943589 [info ] [MainThread]: 
[0m01:11:24.945024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:11:24.946338 [info ] [MainThread]: 
[0m01:11:24.948129 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:11:24.955048 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m01:11:25.018545 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m01:11:25.020216 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m01:11:25.021759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:25.064053 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.042 seconds
[0m01:11:25.067235 [debug] [ThreadPool]: On list_destination_db: Close
[0m01:11:25.070853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m01:11:25.082157 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m01:11:25.083743 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m01:11:25.084926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:11:25.105909 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m01:11:25.106924 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m01:11:25.107890 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:11:25.113385 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m01:11:25.116112 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m01:11:25.119883 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m01:11:25.129593 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:25.130846 [debug] [MainThread]: On master: BEGIN
[0m01:11:25.132074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:11:25.152488 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m01:11:25.153527 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:25.154682 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:11:25.160558 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m01:11:25.163124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be9d8019-120b-4aad-a5ef-00565c0b3fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2bab1b80>]}
[0m01:11:25.164751 [debug] [MainThread]: On master: ROLLBACK
[0m01:11:25.167857 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:25.169265 [debug] [MainThread]: On master: BEGIN
[0m01:11:25.173840 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:11:25.175232 [debug] [MainThread]: On master: COMMIT
[0m01:11:25.176638 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:25.177889 [debug] [MainThread]: On master: COMMIT
[0m01:11:25.180906 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:11:25.182280 [debug] [MainThread]: On master: Close
[0m01:11:25.185622 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m01:11:25.187571 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m01:11:25.189145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m01:11:25.190258 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m01:11:25.202230 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m01:11:25.218148 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m01:11:25.284163 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m01:11:25.292982 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:11:25.294027 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m01:11:25.294974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:25.317288 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m01:11:25.318898 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:11:25.320496 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m01:11:25.325612 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m01:11:25.327464 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m01:11:25.330734 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m01:11:25.342660 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m01:11:25.346000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be9d8019-120b-4aad-a5ef-00565c0b3fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2e01a150>]}
[0m01:11:25.347965 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.16s]
[0m01:11:25.350025 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m01:11:25.351505 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m01:11:25.352448 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.actors' to be skipped because of status 'error'.  Reason: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql.
[0m01:11:25.353850 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m01:11:25.357172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m01:11:25.358887 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m01:11:25.363952 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m01:11:25.373774 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m01:11:25.381140 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m01:11:25.390954 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:11:25.392167 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m01:11:25.393542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:25.413440 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m01:11:25.414539 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:11:25.415464 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m01:11:25.418192 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m01:11:25.419357 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m01:11:25.421571 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m01:11:25.426880 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m01:11:25.428465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be9d8019-120b-4aad-a5ef-00565c0b3fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2a9e9040>]}
[0m01:11:25.430239 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m01:11:25.432006 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m01:11:25.433443 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m01:11:25.434292 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_actors' to be skipped because of status 'error'.  Reason: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql.
[0m01:11:25.435827 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m01:11:25.438631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m01:11:25.439965 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m01:11:25.444692 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m01:11:25.453920 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m01:11:25.460690 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m01:11:25.471125 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:11:25.472397 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m01:11:25.473580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:25.499633 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m01:11:25.501524 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:11:25.503276 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m01:11:25.507266 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m01:11:25.509076 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m01:11:25.512569 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m01:11:25.518830 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m01:11:25.520383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be9d8019-120b-4aad-a5ef-00565c0b3fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2a92dd60>]}
[0m01:11:25.522259 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.08s]
[0m01:11:25.524176 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m01:11:25.526312 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.films' to be skipped because of status 'error'.  Reason: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql.
[0m01:11:25.529131 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m01:11:25.530677 [info ] [Thread-1 (]: 4 of 5 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m01:11:25.532475 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m01:11:25.533847 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m01:11:25.535315 [info ] [Thread-1 (]: 5 of 5 SKIP relation public.specific_movie ..................................... [[33mSKIP[0m]
[0m01:11:25.536859 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m01:11:25.539736 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:25.541107 [debug] [MainThread]: On master: BEGIN
[0m01:11:25.542272 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:11:25.561807 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m01:11:25.563046 [debug] [MainThread]: On master: COMMIT
[0m01:11:25.564212 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:25.565307 [debug] [MainThread]: On master: COMMIT
[0m01:11:25.568202 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:11:25.569322 [debug] [MainThread]: On master: Close
[0m01:11:25.570612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:11:25.571946 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m01:11:25.573625 [info ] [MainThread]: 
[0m01:11:25.575190 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m01:11:25.578687 [debug] [MainThread]: Command end result
[0m01:11:25.656121 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m01:11:25.663276 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m01:11:25.679287 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m01:11:25.680705 [info ] [MainThread]: 
[0m01:11:25.682381 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m01:11:25.683866 [info ] [MainThread]: 
[0m01:11:25.685566 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m01:11:25.687070 [info ] [MainThread]: 
[0m01:11:25.688671 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m01:11:25.690325 [info ] [MainThread]: 
[0m01:11:25.692152 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m01:11:25.693706 [info ] [MainThread]: 
[0m01:11:25.695078 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 TOTAL=5
[0m01:11:25.697942 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.7031713, "process_in_blocks": "101864", "process_kernel_time": 0.377065, "process_mem_max_rss": "111452", "process_out_blocks": "1600", "process_user_time": 3.610402}
[0m01:11:25.699402 [debug] [MainThread]: Command `dbt run` failed at 01:11:25.699257 after 2.70 seconds
[0m01:11:25.700628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2dbddd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2b8628d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2b861460>]}
[0m01:11:25.701824 [debug] [MainThread]: Flushing usage events
[0m01:11:26.082852 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:11:30.933318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06382f3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06381b2780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06381b3590>]}


============================== 01:11:30.937954 | dd6e3b3b-5c59-4d77-93b6-7b91895fafde ==============================
[0m01:11:30.937954 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:11:30.939800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:11:31.210207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd6e3b3b-5c59-4d77-93b6-7b91895fafde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0637627dd0>]}
[0m01:11:31.309434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd6e3b3b-5c59-4d77-93b6-7b91895fafde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0637792570>]}
[0m01:11:31.311496 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:11:31.475954 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m01:11:31.908122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:11:31.909158 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:11:31.989305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd6e3b3b-5c59-4d77-93b6-7b91895fafde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0635d281d0>]}
[0m01:11:32.165325 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m01:11:32.173000 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m01:11:32.210743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd6e3b3b-5c59-4d77-93b6-7b91895fafde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0635957f80>]}
[0m01:11:32.212746 [info ] [MainThread]: Found 5 models, 20 data tests, 3 sources, 430 macros
[0m01:11:32.214321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd6e3b3b-5c59-4d77-93b6-7b91895fafde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0635df0c50>]}
[0m01:11:32.218910 [info ] [MainThread]: 
[0m01:11:32.220453 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:11:32.221871 [info ] [MainThread]: 
[0m01:11:32.224031 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:11:32.237590 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m01:11:32.301558 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m01:11:32.303179 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m01:11:32.304409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:32.328147 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.024 seconds
[0m01:11:32.330563 [debug] [ThreadPool]: On list_destination_db: Close
[0m01:11:32.333462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m01:11:32.344062 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m01:11:32.345421 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m01:11:32.346803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:11:32.368846 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m01:11:32.370061 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m01:11:32.371338 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:11:32.377082 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m01:11:32.379747 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m01:11:32.382435 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m01:11:32.392722 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:32.394036 [debug] [MainThread]: On master: BEGIN
[0m01:11:32.395263 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:11:32.415988 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m01:11:32.417074 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:32.418312 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:11:32.424238 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m01:11:32.427059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd6e3b3b-5c59-4d77-93b6-7b91895fafde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0639440680>]}
[0m01:11:32.428483 [debug] [MainThread]: On master: ROLLBACK
[0m01:11:32.430612 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:32.431579 [debug] [MainThread]: On master: BEGIN
[0m01:11:32.434929 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:11:32.435962 [debug] [MainThread]: On master: COMMIT
[0m01:11:32.437112 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:32.438100 [debug] [MainThread]: On master: COMMIT
[0m01:11:32.440501 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:11:32.441728 [debug] [MainThread]: On master: Close
[0m01:11:32.445395 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m01:11:32.447221 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m01:11:32.448925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m01:11:32.450528 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m01:11:32.463850 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m01:11:32.472139 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m01:11:32.544613 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m01:11:32.554919 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:11:32.556303 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m01:11:32.557560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:32.581487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m01:11:32.582567 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:11:32.583574 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m01:11:32.586986 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.002 seconds
[0m01:11:32.597219 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:11:32.598405 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m01:11:32.601005 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:11:32.605953 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:11:32.607597 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m01:11:32.610786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:11:32.644660 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m01:11:32.646037 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:11:32.647481 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m01:11:32.651846 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m01:11:32.663011 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m01:11:32.671423 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:11:32.672851 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m01:11:32.679632 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:11:32.684269 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m01:11:32.687314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd6e3b3b-5c59-4d77-93b6-7b91895fafde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063939a840>]}
[0m01:11:32.688975 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.24s]
[0m01:11:32.690625 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m01:11:32.691772 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m01:11:32.692983 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m01:11:32.694454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m01:11:32.695553 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m01:11:32.700149 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m01:11:32.706506 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m01:11:32.711812 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m01:11:32.717742 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:11:32.718820 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m01:11:32.719748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:32.737739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m01:11:32.738902 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:11:32.740075 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m01:11:32.744011 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.003 seconds
[0m01:11:32.748835 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:11:32.749912 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m01:11:32.752636 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:11:32.757902 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:11:32.759073 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m01:11:32.761805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:11:32.764505 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m01:11:32.765565 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:11:32.766608 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m01:11:32.773765 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m01:11:32.779380 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m01:11:32.780737 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:11:32.781749 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m01:11:32.786802 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:11:32.789951 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m01:11:32.791302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd6e3b3b-5c59-4d77-93b6-7b91895fafde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0634bfede0>]}
[0m01:11:32.793000 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.10s]
[0m01:11:32.795131 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m01:11:32.796481 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m01:11:32.797993 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m01:11:32.799519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m01:11:32.800875 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m01:11:32.806274 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m01:11:32.813639 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m01:11:32.819388 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m01:11:32.828973 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:11:32.830169 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m01:11:32.831156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:32.850181 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m01:11:32.851561 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:11:32.852674 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m01:11:32.856948 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.003 seconds
[0m01:11:32.862085 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:11:32.863338 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m01:11:32.865845 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:11:32.870804 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:11:32.871944 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m01:11:32.874674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:11:32.877712 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m01:11:32.878856 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:11:32.879796 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m01:11:32.886665 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m01:11:32.891624 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m01:11:32.893245 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:11:32.894250 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m01:11:32.899908 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:11:32.902693 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m01:11:32.904281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd6e3b3b-5c59-4d77-93b6-7b91895fafde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0634bbf050>]}
[0m01:11:32.906391 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.10s]
[0m01:11:32.908700 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m01:11:32.911044 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m01:11:32.912568 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m01:11:32.914007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m01:11:32.915244 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m01:11:32.923443 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m01:11:32.930961 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m01:11:32.936267 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m01:11:32.943711 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m01:11:32.944828 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m01:11:32.945936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:32.964311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m01:11:32.965519 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m01:11:32.967140 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    

WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m01:11:32.973067 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.004 seconds
[0m01:11:32.977980 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m01:11:32.979104 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m01:11:32.981662 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:11:32.985641 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m01:11:32.987062 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m01:11:32.988561 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m01:11:32.995236 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m01:11:32.999970 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m01:11:33.001691 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m01:11:33.003047 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m01:11:33.005971 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:11:33.008653 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m01:11:33.009976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd6e3b3b-5c59-4d77-93b6-7b91895fafde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0634bb4410>]}
[0m01:11:33.011645 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.10s]
[0m01:11:33.013882 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m01:11:33.015671 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m01:11:33.017272 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m01:11:33.019172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_ratings, now model.custom_postgres.specific_movie)
[0m01:11:33.021124 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m01:11:33.032398 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m01:11:33.043413 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m01:11:33.052905 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m01:11:33.062001 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m01:11:33.063602 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m01:11:33.064785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:33.089417 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m01:11:33.092560 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m01:11:33.094281 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "destination_db"."public"."films"
WHERE title = ''
  );
  
[0m01:11:33.100311 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m01:11:33.108020 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m01:11:33.109670 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m01:11:33.113640 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:11:33.118213 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m01:11:33.119696 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m01:11:33.120903 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m01:11:33.131559 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m01:11:33.137542 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."specific_movie__dbt_backup"
[0m01:11:33.139465 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m01:11:33.140687 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m01:11:33.144406 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:11:33.147499 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m01:11:33.149251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd6e3b3b-5c59-4d77-93b6-7b91895fafde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0634c3b140>]}
[0m01:11:33.151183 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 0[0m in 0.13s]
[0m01:11:33.153122 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m01:11:33.155566 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:33.156576 [debug] [MainThread]: On master: BEGIN
[0m01:11:33.157534 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:11:33.177384 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m01:11:33.178957 [debug] [MainThread]: On master: COMMIT
[0m01:11:33.180104 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:33.181250 [debug] [MainThread]: On master: COMMIT
[0m01:11:33.184257 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:11:33.185833 [debug] [MainThread]: On master: Close
[0m01:11:33.187623 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:11:33.190702 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m01:11:33.192284 [info ] [MainThread]: 
[0m01:11:33.193879 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m01:11:33.196917 [debug] [MainThread]: Command end result
[0m01:11:33.255999 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m01:11:33.261538 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m01:11:33.274615 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m01:11:33.275646 [info ] [MainThread]: 
[0m01:11:33.277052 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:11:33.278809 [info ] [MainThread]: 
[0m01:11:33.280319 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m01:11:33.283107 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4926531, "process_in_blocks": "0", "process_kernel_time": 0.292864, "process_mem_max_rss": "109084", "process_out_blocks": "0", "process_user_time": 3.589955}
[0m01:11:33.284610 [debug] [MainThread]: Command `dbt run` succeeded at 01:11:33.284379 after 2.49 seconds
[0m01:11:33.285898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0637791730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06376dd490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0635b9d2b0>]}
[0m01:11:33.287117 [debug] [MainThread]: Flushing usage events
[0m01:11:33.754722 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:13:52.075222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8504020ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8505397920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8503aa8cb0>]}


============================== 01:13:52.083721 | 11282ee7-eac1-440f-8d73-b4dd610aa9c6 ==============================
[0m01:13:52.083721 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:13:52.085733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m01:13:52.371259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11282ee7-eac1-440f-8d73-b4dd610aa9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850334fce0>]}
[0m01:13:52.457450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11282ee7-eac1-440f-8d73-b4dd610aa9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8503f011c0>]}
[0m01:13:52.459450 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:13:52.568872 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m01:13:52.959099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:13:52.961420 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/specific_movie.sql
[0m01:13:53.524799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11282ee7-eac1-440f-8d73-b4dd610aa9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850172b0e0>]}
[0m01:13:53.736543 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m01:13:53.744422 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m01:13:53.785073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11282ee7-eac1-440f-8d73-b4dd610aa9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85015bab40>]}
[0m01:13:53.786448 [info ] [MainThread]: Found 5 models, 20 data tests, 3 sources, 430 macros
[0m01:13:53.787930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11282ee7-eac1-440f-8d73-b4dd610aa9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850187c620>]}
[0m01:13:53.793843 [info ] [MainThread]: 
[0m01:13:53.795845 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:13:53.797541 [info ] [MainThread]: 
[0m01:13:53.799418 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:13:53.807466 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m01:13:53.868975 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m01:13:53.870389 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m01:13:53.871908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:13:53.902371 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.030 seconds
[0m01:13:53.905457 [debug] [ThreadPool]: On list_destination_db: Close
[0m01:13:53.909024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m01:13:53.920945 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m01:13:53.922804 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m01:13:53.924152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:13:53.947717 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m01:13:53.948873 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m01:13:53.949955 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:13:53.955569 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m01:13:53.958478 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m01:13:53.962055 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m01:13:53.971714 [debug] [MainThread]: Using postgres connection "master"
[0m01:13:53.973263 [debug] [MainThread]: On master: BEGIN
[0m01:13:53.974860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:13:53.998522 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m01:13:53.999910 [debug] [MainThread]: Using postgres connection "master"
[0m01:13:54.001695 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:13:54.010220 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m01:13:54.013108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11282ee7-eac1-440f-8d73-b4dd610aa9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850085cb90>]}
[0m01:13:54.014860 [debug] [MainThread]: On master: ROLLBACK
[0m01:13:54.017910 [debug] [MainThread]: Using postgres connection "master"
[0m01:13:54.019067 [debug] [MainThread]: On master: BEGIN
[0m01:13:54.023212 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:13:54.024418 [debug] [MainThread]: On master: COMMIT
[0m01:13:54.025506 [debug] [MainThread]: Using postgres connection "master"
[0m01:13:54.026501 [debug] [MainThread]: On master: COMMIT
[0m01:13:54.028958 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:13:54.030009 [debug] [MainThread]: On master: Close
[0m01:13:54.034122 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m01:13:54.035949 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m01:13:54.037697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m01:13:54.039125 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m01:13:54.051750 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m01:13:54.061220 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m01:13:54.122144 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m01:13:54.133235 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:13:54.134472 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m01:13:54.135545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:54.154780 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m01:13:54.155964 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:13:54.157171 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m01:13:54.160282 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m01:13:54.161914 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m01:13:54.164652 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m01:13:54.173083 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m01:13:54.176554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11282ee7-eac1-440f-8d73-b4dd610aa9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850078bc50>]}
[0m01:13:54.178231 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m01:13:54.180743 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m01:13:54.182063 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m01:13:54.182849 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.actors' to be skipped because of status 'error'.  Reason: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql.
[0m01:13:54.184115 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m01:13:54.186993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m01:13:54.188209 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m01:13:54.192604 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m01:13:54.202111 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m01:13:54.208695 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m01:13:54.220106 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:13:54.221342 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m01:13:54.222373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:54.243766 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m01:13:54.245589 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:13:54.247334 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m01:13:54.251924 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m01:13:54.254089 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m01:13:54.258895 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m01:13:54.265618 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m01:13:54.267228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11282ee7-eac1-440f-8d73-b4dd610aa9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8500828c50>]}
[0m01:13:54.269881 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.08s]
[0m01:13:54.272070 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m01:13:54.273744 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m01:13:54.274765 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_actors' to be skipped because of status 'error'.  Reason: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql.
[0m01:13:54.276153 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m01:13:54.278647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m01:13:54.280186 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m01:13:54.285564 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m01:13:54.295170 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m01:13:54.300695 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m01:13:54.311464 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:13:54.312547 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m01:13:54.313514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:54.341363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m01:13:54.342624 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:13:54.343824 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m01:13:54.346456 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m01:13:54.347613 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m01:13:54.349945 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m01:13:54.354745 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m01:13:54.356133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11282ee7-eac1-440f-8d73-b4dd610aa9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850078b110>]}
[0m01:13:54.357512 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.08s]
[0m01:13:54.359151 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m01:13:54.360612 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.films' to be skipped because of status 'error'.  Reason: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql.
[0m01:13:54.362781 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m01:13:54.364093 [info ] [Thread-1 (]: 4 of 5 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m01:13:54.365425 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m01:13:54.366611 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m01:13:54.367752 [info ] [Thread-1 (]: 5 of 5 SKIP relation public.specific_movie ..................................... [[33mSKIP[0m]
[0m01:13:54.368936 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m01:13:54.371328 [debug] [MainThread]: Using postgres connection "master"
[0m01:13:54.372169 [debug] [MainThread]: On master: BEGIN
[0m01:13:54.372959 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:13:54.392226 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m01:13:54.393344 [debug] [MainThread]: On master: COMMIT
[0m01:13:54.394219 [debug] [MainThread]: Using postgres connection "master"
[0m01:13:54.395053 [debug] [MainThread]: On master: COMMIT
[0m01:13:54.397256 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:13:54.398235 [debug] [MainThread]: On master: Close
[0m01:13:54.399352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:13:54.400419 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m01:13:54.401518 [info ] [MainThread]: 
[0m01:13:54.402763 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m01:13:54.404968 [debug] [MainThread]: Command end result
[0m01:13:54.470518 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m01:13:54.478371 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m01:13:54.493310 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m01:13:54.494859 [info ] [MainThread]: 
[0m01:13:54.496590 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m01:13:54.498306 [info ] [MainThread]: 
[0m01:13:54.500017 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m01:13:54.501549 [info ] [MainThread]: 
[0m01:13:54.503344 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m01:13:54.504818 [info ] [MainThread]: 
[0m01:13:54.506544 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m01:13:54.508019 [info ] [MainThread]: 
[0m01:13:54.509396 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 TOTAL=5
[0m01:13:54.511498 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5320988, "process_in_blocks": "0", "process_kernel_time": 0.269605, "process_mem_max_rss": "112948", "process_out_blocks": "1600", "process_user_time": 3.597839}
[0m01:13:54.512931 [debug] [MainThread]: Command `dbt run` failed at 01:13:54.512748 after 2.53 seconds
[0m01:13:54.514252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8503cfbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8501ad01a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8503f01dc0>]}
[0m01:13:54.515474 [debug] [MainThread]: Flushing usage events
[0m01:13:54.870792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:14:00.027429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7face6ad5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7face81652b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7face6ad6f90>]}


============================== 01:14:00.032012 | 970f278b-622a-400a-90b0-5fc90f5f587f ==============================
[0m01:14:00.032012 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:14:00.033657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/root', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:14:00.455821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '970f278b-622a-400a-90b0-5fc90f5f587f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7face678d8e0>]}
[0m01:14:00.562631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '970f278b-622a-400a-90b0-5fc90f5f587f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7face6f47650>]}
[0m01:14:00.564269 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:14:00.694037 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m01:14:01.050532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:14:01.051534 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:14:01.130913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '970f278b-622a-400a-90b0-5fc90f5f587f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7face4e2f710>]}
[0m01:14:00.682013 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m01:14:00.689078 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m01:14:00.720122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '970f278b-622a-400a-90b0-5fc90f5f587f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7face4a23d70>]}
[0m01:14:00.721464 [info ] [MainThread]: Found 5 models, 20 data tests, 3 sources, 430 macros
[0m01:13:59.960906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '970f278b-622a-400a-90b0-5fc90f5f587f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7face4c34a70>]}
[0m01:13:59.966685 [info ] [MainThread]: 
[0m01:13:59.968705 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:13:59.971416 [info ] [MainThread]: 
[0m01:13:59.974860 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:13:59.989708 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m01:14:00.051196 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m01:14:00.052257 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m01:14:00.053161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:00.072676 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.019 seconds
[0m01:14:00.075384 [debug] [ThreadPool]: On list_destination_db: Close
[0m01:14:00.078440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m01:14:00.088423 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m01:14:00.089668 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m01:14:00.090849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:14:00.112792 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m01:14:00.113784 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m01:14:00.114721 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:14:00.119766 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m01:14:00.122731 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m01:14:00.125508 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m01:14:00.136074 [debug] [MainThread]: Using postgres connection "master"
[0m01:14:00.137235 [debug] [MainThread]: On master: BEGIN
[0m01:14:00.138206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:14:00.157341 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m01:14:00.158513 [debug] [MainThread]: Using postgres connection "master"
[0m01:14:00.160123 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:14:00.166483 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m01:14:00.169169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '970f278b-622a-400a-90b0-5fc90f5f587f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7face4e5f110>]}
[0m01:14:00.170326 [debug] [MainThread]: On master: ROLLBACK
[0m01:14:00.172545 [debug] [MainThread]: Using postgres connection "master"
[0m01:14:00.173550 [debug] [MainThread]: On master: BEGIN
[0m01:14:00.177110 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:14:00.178216 [debug] [MainThread]: On master: COMMIT
[0m01:14:00.179439 [debug] [MainThread]: Using postgres connection "master"
[0m01:14:00.180477 [debug] [MainThread]: On master: COMMIT
[0m01:14:00.183002 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:14:00.184336 [debug] [MainThread]: On master: Close
[0m01:14:00.187655 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m01:14:00.189349 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m01:14:00.190985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m01:14:00.192052 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m01:14:00.205393 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m01:14:00.213504 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m01:14:00.283188 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m01:14:00.292101 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:14:00.293199 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m01:14:00.294196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:00.317838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m01:14:00.319280 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:14:00.320631 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m01:14:00.325662 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.004 seconds
[0m01:14:00.335970 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:14:00.337614 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m01:14:00.340645 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:14:00.345751 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:14:00.347182 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m01:14:00.350393 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:14:00.386756 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m01:14:00.388183 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:14:00.389572 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m01:14:00.397033 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m01:14:00.407886 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m01:14:00.417956 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:14:00.419633 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m01:14:00.426136 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:14:00.430707 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m01:14:00.435147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '970f278b-622a-400a-90b0-5fc90f5f587f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7face82b64b0>]}
[0m01:14:00.437635 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.24s]
[0m01:14:00.439466 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m01:14:00.440768 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m01:14:00.442143 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m01:14:00.443619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m01:14:00.444740 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m01:14:00.449393 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m01:14:00.458698 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m01:14:00.463959 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m01:14:00.473231 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:14:00.474369 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m01:14:00.475372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:00.495829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m01:14:00.497294 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:14:00.498416 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m01:14:00.502129 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.002 seconds
[0m01:14:00.507076 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:14:00.508313 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m01:14:00.511893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:14:00.517588 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:14:00.518995 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m01:14:00.522539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:14:00.525499 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m01:14:00.526681 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:14:00.528099 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m01:14:00.532395 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m01:14:00.538827 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m01:14:00.540844 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:14:00.542096 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m01:14:00.547528 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:14:00.550599 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m01:14:00.552185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '970f278b-622a-400a-90b0-5fc90f5f587f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7face22d80e0>]}
[0m01:14:00.553710 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.11s]
[0m01:14:00.555816 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m01:14:00.557405 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m01:14:00.558885 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m01:14:00.560461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m01:14:00.561699 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m01:14:00.566786 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m01:14:00.575331 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m01:14:00.580939 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m01:14:00.591802 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:14:00.592938 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m01:14:00.593890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:00.616609 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m01:14:00.618751 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:14:00.620317 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m01:14:00.624433 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.003 seconds
[0m01:14:00.630476 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:14:00.631955 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m01:14:00.635138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:14:00.640193 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:14:00.641395 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m01:14:00.644686 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:14:00.647649 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m01:14:00.648934 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:14:00.649993 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m01:14:00.656911 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m01:14:00.661373 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m01:14:00.663117 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:14:00.664745 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m01:14:00.671687 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:14:00.674590 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m01:14:00.676324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '970f278b-622a-400a-90b0-5fc90f5f587f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7face229a1e0>]}
[0m01:14:00.678285 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.12s]
[0m01:14:00.680254 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m01:14:00.682845 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m01:14:00.684552 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m01:14:00.686186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m01:14:00.687729 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m01:14:00.694768 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m01:14:00.702842 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m01:14:00.709118 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m01:14:00.717236 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m01:14:00.718293 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m01:14:00.719633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:00.738974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m01:14:00.740624 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m01:14:00.741911 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    

WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m01:14:00.748385 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.005 seconds
[0m01:14:00.753437 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m01:14:00.755005 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m01:14:00.757850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:14:00.760428 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m01:14:00.761411 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m01:14:00.762329 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m01:14:00.769168 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m01:14:00.774087 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m01:14:00.775819 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m01:14:00.777048 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m01:14:00.780095 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:14:00.782695 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m01:14:00.784132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '970f278b-622a-400a-90b0-5fc90f5f587f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7face229af30>]}
[0m01:14:00.785617 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.10s]
[0m01:14:00.788033 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m01:14:00.789674 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m01:14:00.791174 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m01:14:00.792487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_ratings, now model.custom_postgres.specific_movie)
[0m01:14:00.794041 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m01:14:00.799245 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m01:14:00.807194 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m01:14:00.816085 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m01:14:00.823210 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m01:14:00.824499 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m01:14:00.825566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:00.844951 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m01:14:00.846582 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m01:14:00.851311 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "destination_db"."public"."films"
WHERE title = 'Dunkirk'
  );
  
[0m01:14:00.857632 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m01:14:00.863791 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m01:14:00.864983 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m01:14:00.867875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:14:00.871765 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m01:14:00.873194 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m01:14:00.874455 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m01:14:00.881184 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m01:14:00.887589 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."specific_movie__dbt_backup"
[0m01:14:00.889315 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m01:14:00.890699 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m01:14:00.893691 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:14:00.896325 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m01:14:00.897884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '970f278b-622a-400a-90b0-5fc90f5f587f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7face2314890>]}
[0m01:14:00.900224 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.11s]
[0m01:14:00.902231 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m01:14:00.904800 [debug] [MainThread]: Using postgres connection "master"
[0m01:14:00.905843 [debug] [MainThread]: On master: BEGIN
[0m01:14:00.907060 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:14:00.925630 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m01:14:00.926723 [debug] [MainThread]: On master: COMMIT
[0m01:14:00.927611 [debug] [MainThread]: Using postgres connection "master"
[0m01:14:00.928630 [debug] [MainThread]: On master: COMMIT
[0m01:14:00.931263 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:14:00.932430 [debug] [MainThread]: On master: Close
[0m01:14:00.933819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:14:00.934991 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m01:14:00.936065 [info ] [MainThread]: 
[0m01:14:00.937729 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m01:14:00.940724 [debug] [MainThread]: Command end result
[0m01:14:01.007210 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m01:14:01.013070 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m01:14:01.026674 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m01:14:01.027744 [info ] [MainThread]: 
[0m01:14:01.029243 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:14:01.030763 [info ] [MainThread]: 
[0m01:14:01.032178 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m01:14:01.034556 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5210485, "process_in_blocks": "0", "process_kernel_time": 0.28043, "process_mem_max_rss": "107576", "process_out_blocks": "0", "process_user_time": 3.577909}
[0m01:14:01.036138 [debug] [MainThread]: Command `dbt run` succeeded at 01:14:01.035953 after 2.52 seconds
[0m01:14:01.037309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7face6956ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7face70a4560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7face83fef30>]}
[0m01:14:01.038660 [debug] [MainThread]: Flushing usage events
[0m01:14:01.343058 [debug] [MainThread]: An error was encountered while trying to flush usage events
